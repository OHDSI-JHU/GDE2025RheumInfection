CREATE TABLE #Codesets (
  codeset_id int NOT NULL,
  concept_id bigint NOT NULL
)
;

INSERT INTO #Codesets (codeset_id, concept_id)
SELECT 0 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (38004276,38004281,38004286,38004275,38004280,262,38004270,38004279,38004515,32254,581383,581379,8717,581384,8971,9201,32037,32760,38004277,38004290,38004288,38004291,8913,38004284,38004285,38004278,38004282,38004287,38004274,38004283)

) I
) C UNION ALL 
SELECT 10 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (38004232,38004210,38004231,38004208,38004209,705159,581479,8883,38004211,38004213,8650,38004256,38004693,38004207,38004216,903270,8964,8947,38004217,32276,38004215,38004218,38004219,38004204,38004220,8870,581381,9203,8949,38004222,38004453,38004243,8966,38004225,32693,38004226,38004227,38004515,8716,38004702,8968,8969,38004228,38004229,38004238,38004677,38004251,8858,38004240,38004242,38004241,38004233,38004237,38004235,38004290,38004288,38004236,8905,38004234,38004252,38004253,8584,38004239,38003820,722457,8974,38004223,581385,38004267,5084,581477,38004268,38004291,38004262,38004261,581380,8756,9202,38004249,38004246,38004245,38004247,38004248,722458,8977,38004269,38004696,38004250,38004258,38004526,38004254,32261,38004259,8761,38004260,38003821,38004264,38004244,38004263,38004257,8941,8960,8782,38004266,38003620)

) I
) C UNION ALL 
SELECT 13 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (1736971,1703687,1729323,19123877,19088223,1790868,19010337,1726228,1713332,1717240,1717327,1789428,19026450,19101402,46233931,1727223,46221507,19018516,1734104,19015123,1715117,1734205,915175,43012398,35201105,43012518,40238770,19122130,19018742,739588,19026710,1740546,1718054,1768849,1769535,19070174,19070680,1771162,1796458,1747005,1748975,19028241,37498010,1796435,19072255,19028286,19072857,1773402,19028288,1774470,1774932,19051271,1775741,19001904,1749008,1738366,19051345,46274210,1776684,1749083,1777254,45892599,1777806,1778162,1786621,19052683,19086759,19086790,1786842,990069,19095043,1745072,997496,1797513,1750500,1759842,997881,1798476,19047240,19047265,1800835,901845,1710446,46221696,45774861,1711759,1786617,1756831,45892558,1592954,1747157,1714527,19023508,1724666,1724869,1790024,43560385,35200446,1713905,1738521,1738135,35606465,42874212,1703069,1717002,1743222,1711246,35200469,1717963,1746940,1749301,1750074,1758536,1703603,19050750,19054936,1754994,1755112,19064329,1736829,1724700,956653,1146410,19010400,1757803,1789276,1716721,45892419,793843,35606467,1747032,19069006,42544019,19078156,1778262,1711523,19083285,35606695,1782521,1703653,19123240,1784749,985708,1704183,37496518,792929,1742253,1790692,1736887,1707800,1738170,1708100,19092353,43532424,19008870,1787101,1709170,19003644,19072054,904356,1361385,1707164,19007701,19018013,907879,19072122,1708880,19009138,19010924,19126622,1716903,1713930,986864,1715472,915981,19017585,1769389,920293,19015464,1721543,923081,19023254,35200953,45892552,45776147,19024197,1799139,1724703,19129642,925952,19027679,981654,1728416,1729720,40167569,19088795,19010564,1746114,19047071,1560047,948582,1704139,37496482,19125201,19096054,19135812,1759455,1789515,1712889,37499271,1762711,1777417,1763204,19136008,19035924,19035953,40238930,1763339,1748921,19136024,19036545,19063874,1746244,35200881,44785086,19136044,44785094,1733765,1701651,19070251,1781406,1836191,19136210,1836241,19000817,1836391,19000818,19136423,19136426,19136429,1036425,1836430,19000820,19040624,19136481,1036475,19136493,1036487,19000821,1836503,19002077,1741122,35200354,45775686,19078399,40239330,40166675,1758392,1702911,19041153,19100438,35605546,1710281,19078424,1836948,19137362,1702364,1742432,1702559,1736999,902722,1705674,19006043,19101679,1712549,792531,1717704,1703063,1707687,908126,1714277,19102105,1724827,1708748,1710612)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (1736971,1703687,1729323,19123877,19088223,1790868,19010337,1726228,1713332,1717240,1717327,1789428,19026450,19101402,46233931,1727223,46221507,19018516,1734104,19015123,1715117,1734205,915175,43012398,35201105,43012518,40238770,19122130,19018742,739588,19026710,1740546,1718054,1768849,1769535,19070174,19070680,1771162,1796458,1747005,1748975,19028241,37498010,1796435,19072255,19028286,19072857,1773402,19028288,1774470,1774932,19051271,1775741,19001904,1749008,1738366,19051345,46274210,1776684,1749083,1777254,45892599,1777806,1778162,1786621,19052683,19086759,19086790,1786842,990069,19095043,1745072,997496,1797513,1750500,1759842,997881,1798476,19047240,19047265,1800835,901845,1710446,46221696,45774861,1711759,1786617,1756831,45892558,1592954,1747157,1714527,19023508,1724666,1724869,1790024,43560385,35200446,1713905,1738521,1738135,35606465,42874212,1703069,1717002,1743222,1711246,35200469,1717963,1746940,1749301,1750074,1758536,1703603,19050750,19054936,1754994,1755112,19064329,1736829,1724700,956653,1146410,19010400,1757803,1789276,1716721,45892419,793843,35606467,1747032,19069006,42544019,19078156,1778262,1711523,19083285,35606695,1782521,1703653,19123240,1784749,985708,1704183,37496518,792929,1742253,1790692,1736887,1707800,1738170,1708100,19092353,43532424,19008870,1787101,1709170,19003644,19072054,904356,1361385,1707164,19007701,19018013,907879,19072122,1708880,19009138,19010924,19126622,1716903,1713930,986864,1715472,915981,19017585,1769389,920293,19015464,1721543,923081,19023254,35200953,45892552,45776147,19024197,1799139,1724703,19129642,925952,19027679,981654,1728416,1729720,40167569,19088795,19010564,1746114,19047071,1560047,948582,1704139,37496482,19125201,19096054,19135812,1759455,1789515,1712889,37499271,1762711,1777417,1763204,19136008,19035924,19035953,40238930,1763339,1748921,19136024,19036545,19063874,1746244,35200881,44785086,19136044,44785094,1733765,1701651,19070251,1781406,1836191,19136210,1836241,19000817,1836391,19000818,19136423,19136426,19136429,1036425,1836430,19000820,19040624,19136481,1036475,19136493,1036487,19000821,1836503,19002077,1741122,35200354,45775686,19078399,40239330,40166675,1758392,1702911,19041153,19100438,35605546,1710281,19078424,1836948,19137362,1702364,1742432,1702559,1736999,902722,1705674,19006043,19101679,1712549,792531,1717704,1703063,1707687,908126,1714277,19102105,1724827,1708748,1710612)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 14 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (444202,4179538,4214610,4029776,4078384,760084,4153106,4273250,36685120,4228164,4212378,37016126,4320810,4339469,381308,4061734,4200967,4195436,4266590,4248277,37016127,197328,46274074,4144386,759844,36685157,37310601,36717200,36717312,4061735,201901,45773202,4154088,4025165,4266864,40490858,4147598,200757,4336155,759845,36685228,37310602,36713155,36713154,46269899,4137468,46270324,46270323,4055874,4064507,4030976,4010825,4271572,40483785,4151763,4196973,4267135,4105195,4112822,4288676,196149,44784251,4329572,4048517,37162680,198809,605225,45768997,44783894,4239213,193240,4001819,4185268,4284564,37162868,4337445,4090689,4049458,4303234,133002,4345584,135350,4001283,4003293,4001812,4003168,4001281,4317283,4118015,4032851,4001282,4002826,4345583,136511,4032852,141662,4115172,141944,4138536,4121601,37117154,141666,4001280,4001499,4001498,4003294,4001284,134738,4032855,4001817,4215452,606232,4001816,4003296,4002824,37108666,4001814,4001815,133573,4032853,4002827,4032854,4001813,4001818,4002825,40480703,4031120,199074,46274136,4341764,37162867,4060950,42536650,45770911,4082065,4087776,4241693,4280571,197035,196735,4026157,4026158,4080186,4042397,4100954,4240452,436903,254677,37165238,4032273,45772085,4165550,4006304,37116451,4326601,4148713,252548,440448,434869,4170900,761853,4050869,132736,4179072,607328,607318,607317,607327,607330,43530750,43530753,46270092,607319,607326,4206696,4327861,4294444,193402,436091,257315,37019058,4223032,4116487,35615028,4138769,4245006,36687129,3182462,4236311,200440,44806251,40482450,4047816,4200680,4063812,4066361,4065984,4065988,4201258,4150064,4029504,4143494,4080184,4001955,256722,46269707,46269708,46269709,46269710,46269711,46269712,46269713,46269714,46269715,46269716,46269717,46269718,46269719,46269720,46269721,46269722,46269723,46269724,46269725,46269726,3654605,3174765,432556,260041,4222062,4212079,4107054,4276198,4263692,4169102,4063806,4216263,4310966,442584,4069115,4270206,4063807,444418,4065976,4178125,4169234,141089,4077307,4296450,442638,4028236,4061712,4001887,4067383,4261626,4061215,605396,37159814,37159841,37159809,37159815,37159837,602647,37159807,605401,37159811,37159831,37159818,135027,4065977,4199541,4219067,444287,4042997,4099596,4277942,602289,37159813,37159842,37159810,37159816,37159840,602648,37159808,605400,37159812,37159832,37159817,4234232,4186603,4282319,200171,4230505,4275118,4238684,4199152,135335,4031037,4291312,4201700,4313133,43020558,435613,4146462,4063818,4066720,4063910,4061719,4065998,75337,4150176,4066369,4063817,4061720,136496,79898,4065991,4066717,442068,4066367,4063906,3654603,4063914,4061722,4061723,4066371,42709830,30163,4146236,4066718,4063909,4065996,4061717,4066370,78497,197950,4065999,76493,42709845,4066719,42538555,4246395,1246543,1246544,4085268,4023773,762387,764983,4294696,4003007,4186208,3172917,4001160,4245143,4243343,4009176,76492,4080188,4200502,4189011,4289531,4335873,4065997,4100662,759854,759855,4283087,4025485,4028237,4061725,4117877,4030220,4100945,1245282,4032730,1245277,4228503,4267714,4117685,4028238,4210482,4318545,1245268,4031752,4028202,443786,36685954,36685928,1246527,761806,760152,765117,759850,759857,1246482,1246484,759856,36685930,1246508,36685956,1246509,1246480,3176352,762413,1246510,759852,1246516,762376,1246525,1246517,1246486,36685960,36685952,1246488,36685962,1246523,762412,759860,36685958,4113790,4180079,1245271,1245283,42709839,42709838,4001520,1245269,46270066,436720,4290877,134074,4003011,4032272,4031131,4080916,4032338,4095399,4030977,765508,762406,762401,443757,4334404,36685955,36685929,1246528,761807,765316,762411,759851,759858,1246483,1246485,765195,36685931,1246518,36685957,1246519,1246481,762414,1246520,759853,1246521,765476,1246526,1246522,1246487,36685961,36685953,1246489,36685963,1246524,762410,759859,36685959,1245270,4179335,4147453,1245278,4006320,4175965,4047781,4206425,4130215,4003020,4003017,4215822,4033181,4321868,4299264,1245279,42709953,4320944,1245280,1245281,4001661,4263898,4305341,4208980,4244370,42709799,45773689,4034708,4087725,4325422,4084794,4089362,4199268,4110510,36715951,37165217,198076,35208372,4119795,45757644,605242,45768998,4056319,45767051,46269693,45769386,4221767,4266498,4230386,3175426,435182,4293463,4048518,4048519,36715867,436021,141498,4276193,3180888,252949,4032731,4329439,4328679,35208257,4048485,37160523,45605946,45567317,4325376,77025,3171798,4298577,37160967,4144248,4154614,4284098,42536652,45576994,45586726,45552940,45557662,4006303,36685121,4260535,45552938,4326827,4334634,4322739,46269900,193239,37116441,45591596,4340961,4140472,4125953,4125951,4177385,3189306,37161095,4033929,138346,36687131,4300219,36687130,1340272,1340380,1340436,1340437,45768914,36683379,4345227,4342865,4090458,4046011,4048676,4274981,4049965,4220002,4238732,4169415,4279304,4247171,4279375,198822,4106878,4323822,132391,4327172,4068162,442325,444071,4071026,135611,4263369,4102161,4337374,602292,759836,37159805,37159823,602646,605398,602290,37159819,759835,37159825,36685922,37159827,36685924,37159830,4185761,4136096,436188,4163393,4094087,602293,759837,37159806,37159824,605397,605399,602291,37159820,765174,37159826,36685923,37159828,36685925,37159829,4078359,4146982,4200994,4235280,4277451,4300074,37159821,37159822,442753,4104821,444261,4056330,4291665,4111105,4341763,46273522,36712963,609030,608793,37312531,761854,36717279,609029,608794,439928,4322625,433696,4051339,4103099,4081904,4176270,4294443,4248029,252655,4298857,260754,437538,4033662,4248807,4256894,46269901,4111119,4051335,256036,441787,4051338,440323,36712850,4143092,4135197,37110291,4340960,37110292,45769390,4297478,140480,4160460,4230388,4066374,4063922,4066723,4338750,4063921,37165493,4149849,37394479,4186568,3655286,4273378,1075641,3655969,4262720,4116488,4114030,4097550,4112820,4080435,4145369,4218175,37169758,4136344,4091311,4133224,443600,4025487,4124539,4195014,4170220,4315046,435785,4102297,434860,4088376,442336,45757267,46269916,46269857,46269917,4100102,4044930,437777,438338,4052546,133691,3172535,3170862,4052548,4346165,4001651,4051336,4136809,4048052,1075912,133566,35622404,4051333,4051337,46284320,46287153,4110509,4030846,4044931,4174281,434942,4284985,252552,141663,133853,443631,138847,137648,140191,134137,133003,133296,4274802,439857,36716700,4057822,46269895,46269896,46269897,37016128,46273469,46269902,46269903,4145073,40482954,4205578,37017566,37019087,4321588,196152,4010826,4248002,4165681,4294404,4088214,4245499,4141619,432879,258785,4221503,438350,4190647,255848,256723,4256236,257908,45757206,46269954,37119233,254066,260430,258180,37116366,40481839,4299862,37016927,40482061,46270121,46270318,253790,46270027,46274035,440431,4110506,4193964,252351,37163210,436145,3661408,45768961,45768960,45771022,40479642,40480033,261324,40481335,607087,4110039,4050872,261053,253235,4137435,259048,4166072,4228277,4110507,3655111,1075640,4226132,260028,4082334,4231944,4153356,4143888,4340494,37174491,4200891,36683380,4195936,1244146,199863,4215594,4112655,4024972,258354,443741,256622,4087778,4324261,4049797,258061,4221865,443327,4223976,4200014,37017277,37017278,44784423,4291608,44782989,37018755,35209268,200761,4178397,437313,4184896,4050874,3175074,4117114,4102253,4114031,45770900,437772,258333,4088085,4344609,4204819,4030847,442637,132797,40487062,40487063,40486631,37018499,37162933,607321,40487617,607320,40489980,46269946,40487064,40493038,40486059,40487662,42539372,40486685,40491960,37018498,40491961,36715806,40493039,40493415,40487059,40489907,760987,40489908,40489909,40489910,40489912,40487616,40489913,36684427,42536690,760981,4345360,4345445,4025014,4243523,4220074,436090,4031461,259852,37162858,4080301,4300222,4032267,440390,4284844,4091027,4096702,46273632,4276663,4089507,4340495,4119436,4008132,4234563,441775,4244239,40492396,40491859,4022138,254266,4280213,4212120,35209371,46270377,45757595,40443382,3655409,3178291,4341765,433403,261326,37162295,4225318,46272377,4343215)

) I
) C UNION ALL 
SELECT 15 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (43530828,43530817,43021949,43021954,43021625,43021062,43021629,43021050,37206199,46270143,37163436,46270319,45757648,40480849,45770931,37207738,37208272,37310680,37207739,37208271,37310679,46269936,43021047,43021948,43021046,43021051,42536620,42536507,40483230,46269838,46269842,46269848,46269859,46269888,46274073,46269878,46269883,45763562,46269951,46274074,43021953,37209434,37309702,37310601,37309706,43020612,45773202,43530846,37172246,37172577,40490858,37310600,43531493,37209067,37209068,43021061,37209433,37309699,37310602,37309707,43020611,46273184,46269899,37175351,46270324,46270323,37209057,37209058,37209056,37209059,37209060,37209061,37209062,37209063,37209069,37209064,44782607,44783946,37209553,37208269,37310678,37310677,37170846,37209554,37208268,37310676,37310675,37170849,46270001,43020688,40483785,40481093,40481109,43021623,43021339,37160811,46273617,45757541,45757102,37160737,37162493,37162492,40482063,44784251,46270510,37163324,44808497,45763725,37166017,37160689,40490363,40487367,37162680,45766910,45757664,40483342,44783894,37160688,37160683,37160682,40482414,43020873,37163083,37163029,37160727,37160684,46269738,46269739,46269740,45757527,37163027,45768740,37163064,37167153,40480703,40490364,40491869,40492373,37163066,42536650,45770911,40487368,37174133,37160681,45769438,45769352,45769351,45769350,37312037,44806552,37160836,37160842,37167221,37165238,37166798,37160700,37311946,45766725,45766726,40481374,42690418,37312275,40481906,45772085,37162526,37162525,37175321,37164923,37164924,37164926,37164925,46270069,37160701,37160808,40480709,37209324,37209325,37209327,37209326,42534826,37207828,42534821,37310649,42534824,37310648,37208262,37310673,37208263,37310647,37310489,42534823,37207830,46273991,42534825,37207831,42539396,37310646,42539287,37310645,37208261,37310672,37208264,37310644,37310490,42534822,37207833,42538751,37162473,37162472,37160738,37161137,37160724,37160845,37160827,42538959,42538960,37312027,37312026,37312025,42872408,37160698,43530750,43530753,46270092,46273193,46273196,46271147,46273200,46273622,46273216,46273215,37160675,37399734,46273201,37160728,40483321,40481574,37161116,37395580,45766332,37161127,37395581,45766333,45766331,45757276,37160736,37169235,37169236,37209315,37169186,37169472,37309745,37309744,37209444,37169433,37169445,37169212,37309743,37170178,37169450,37169520,37169474,37169522,37169521,44806251,44805136,37160699,37162474,37162475,42709817,42709816,45757100,46269741,46269707,46269708,46269709,46269710,46269711,46269712,46269713,46269714,46269715,46269716,46269717,46269718,46269719,46269720,46269721,46269722,46269723,46269724,46269725,46269726,37161159,37161161,37161158,37311996,37160697,37160735,37161094,37160711,37395957,37168907,45757655,42534937,44809978,37167460,45757557,40482646,46272754,44784132,42537216,45763849,43020558,42709830,42709845,42538555,42709839,42709838,46270066,42709953,42709799,45773689,37160686,37160725,37160742,37396526,37396687,37165217,37160828,45757108,42872403,37160712,44783780,37167410,37167412,37167411,45768446,37204076,45769525,37160741,37163708,45757644,45767113,37160739,37175235,37160458,37160906,37175349,45766656,45757726,42872885,45768808,46271951,46270392,46270393,46273518,46270394,46270433,46273644,42534900,42534898,37173697,46270395,42534899,42539293,37173698,46270396,40482025,46269693,37163707,37170118,37169802,37312010,42536529,42537043,42536598,40487101,44813566,45763575,37160835,37160731,37160730,37160734,37162747,37160708,45757223,45763776,37396746,37399559,37395778,37160713,42538865,37168816,37169438,37209445,37169435,37209443,37169434,43021292,43021293,43021291,44783176,37168932,46273147,37311061,37160694,44784224,37160714,37399474,37162520,37162519,37397666,40481825,37160846,40479168,45772089,37160677,37160674,46273984,45757222,37160679,37160680,37160820,42536619,43530819,37160696,44782509,44783396,44783397,44782510,44783399,44783400,40484028,45757231,45757232,45772090,45757233,45757234,45757235,40481404,45757236,45757237,37174329,42536597,45757390,42538551,42539347,42536589,46269900,45757218,45765459,37167379,37167378,37167384,37167381,37167386,37167376,37167387,37311995,45772092,45757240,37161093,37161090,37160678,37160692,42538853,42538554,42538852,45771088,45763820,45757204,37160661,40479557,37160659,37160664,37160853,46274061,46270124,37168931,37310284,37163131,43021996,37164529,37164544,37164531,37164543,37162522,37162521,45757207,40490812,40489338,40489339,40489340,46273592,37162513,37164581,37164583,37162512,37161095,37162495,37162494,37160832,37160709,37162478,37162476,37160710,37162485,37162484,37160707,37162488,37162487,37162490,37162489,37160833,37160844,45768728,37168817,37169444,37169447,40217285,37169807,37160693,37162217,42539147,37160706,45757243,45768911,45772937,42536921,45768908,37165040,37164540,37394468,45765660,46273571,37160796,37161038,42539543,37160837,37396114,45768718,43021939,45770841,46269746,43530899,37167380,37167377,37167383,37167382,37167385,37167375,37167388,37395680,37395696,37160834,37160690,37160691,37311963,37161328,37161334,37168439,37161923,37170160,37161316,37161906,37161330,37161236,37165261,37167420,37161922,37161470,37161315,37161904,37161336,37161234,37168440,37168441,37169808,37169813,37160825,40484011,37160822,37160801,37161113,37161097,45757067,37169810,37164450,46273522,37312531,44783944,44783945,46269910,45757062,37163133,46269737,46274030,46269736,37310283,37163132,37396146,37163129,37163134,45757127,45757066,42536561,42536562,42536558,45757774,45768620,37163828,45757420,37204028,37160704,37160676,37162524,37162523,45769409,37161004,45768655,37162648,45773219,45765602,37169811,37169806,45757248,37169815,45757712,45757249,45757250,45757125,37309610,37311937,42536622,45757134,46273753,45769497,45769496,46270529,37169804,37399017,37311983,46270037,46270152,46270142,40483136,40482214,37164421,44809233,44809234,44809236,44809237,44809238,44809239,45757252,37163864,37160802,44782844,37164620,37160818,37160805,40484151,37160817,37161449,37169819,37160803,37169805,45770924,45770836,45757253,37165499,37165500,37160819,46284256,37160662,40479603,45757132,42536591,42536590,42536593,42536592,42536594,42539031,42536596,42536595,37169809,45772094,37160660,37169801,42538552,37396005,40487859,37162067,42536181,37169835,43530910,43530964,43530941,43530947,43530945,37165493,37161957,37167615,44784425,40481618,40480515,42535216,37311635,37311636,37310070,37310004,37309946,37310063,37310054,37310009,37309964,37310052,37309986,37310050,37310012,37310072,37309999,37309947,37310064,37310055,37310010,37309965,37310053,37309987,37310051,44790687,43021343,43021989,44809231,44809230,44806642,43021267,40481073,43021257,43021264,43021258,43021260,43021259,43021278,43021980,43021986,43021981,43021985,37169993,37167687,37309799,37309829,37309798,37309800,37309830,37309779,37309778,37309854,37309869,43021984,43021261,43021283,43021284,44806641,40481774,40484496,40478938,40484019,40482261,40481403,46271001,40485011,40485012,40481816,44783575,40484638,40484640,42709978,40482676,37311224,46270014,37174322,37204204,37168292,37168285,37168276,37168283,37168272,37168280,37168287,37168290,37168278,40492698,45768770,37171368,45757364,37164444,37164443,45757389,46273307,42689579,42872866,46269914,37161148,37161147,37161145,37161146,37161144,40486500,37166007,37172704,40487826,44784199,45757690,46270005,40492322,45757238,46271136,45757368,42536618,42536625,42539546,42536624,42536623,42536748,42538546,46270495,46270494,40488811,42537495,42537540,42537497,37163105,37163106,42536600,40483549,40481969,40480732,40480731,40482509,37160743,37169698,43020453,40487398,37395903,42539032,40492346,37166825,37160732,37169213,37169211,37163099,37160729,37208110,42536587,42536588,40487890,37160823,37167973,40485376,42536585,37163566,37163849,40486245,37395728,44783865,37396885,37161356,37161349,37161357,37161347,42536583,42537780,37163385,42537660,37163850,46269909,42536599,44783254,40480687,40487007,37169696,45757187,43021263,37167975,37161112,40489336,40488377,40480129,43531491,42534886,40488348,40492367,42537647,37163811,42536747,37398947,37165509,37395724,37160800,37208108,40490303,40483694,46269792,40483734,40479196,40482636,37174258,37169175,37168994,43021262,37396756,37310286,37169679,37311936,40492401,37164062,40492382,40485019,37394535,37398744,37394534,37394536,44806672,44806682,37394537,37398745,44806675,37160798,45757688,40493262,43020879,37311935,37162222,37162218,37162220,37162221,37162219,37312551,45757573,40481620,40489947,40483813,40489948,40489491,42534831,37310488,37310482,37310484,42534829,37310486,40493024,40481619,40486203,42534832,37310487,37310481,37310483,42534830,37310485,40483847,43021067,40547222,37160627,43021950,43021059,43021612,43021060,43021297,43021187,43021058,43020882,43020881,43021063,43021935,43020875,43021048,43020877,43021947,43021044,43021049,43020876,43021043,43021045,43021622,42534954,37311727,40482069,40482019,40480545,37164582,40482439,37164584,40479600,37312673,40481765,37162066,40483537,40484544,42872723,45768913,42872724,37394477,37394478,37394476,42537960,37394479,40408433,45768834,37160799,37160797,46273593,42709901,37209318,37209449,37209319,37160815,46269907,40490397,40486463,40492347,37161037,40487385,46273241,40488844,40491891,37163163,37160816,37160814,37160812,37160813,45772913,45768731,37160810,46269950,37169442,37169443,37209448,37209447,45763768,37160658,37160809,37160705,37160843,37160857,37160858,37160855,40481431,37311934,46270516,37160656,37160806,37311924,37312548,37311923,37172292,40485064,37170170,37161963,37161266,37161433,37162036,37161300,37169419,37161816,37161318,37169449,37161822,37162038,37161317,37161858,37161319,37171291,37161320,37161778,37169227,37161820,37161232,37209401,37163130,37161298,37164448,37161091,45766390,37395591,42536746,42536499,37160856,42709904,37399541,37168079,37164853,42539689,37160657,37160654,37160807,45757192,37312143,37312142,37161125,42534945,37161469,40482020,37160726,40482489,45757267,45757221,46269916,46269917,45757257,46269919,37160850,46269920,37161103,37160702,37162497,37162496,44793072,45763594,45771328,37160655,37160671,37161982,37160847,37204697,37169816,37161176,37160848,46284910,37160841,37160852,37162499,37162498,37160859,37160821,45772905,37161099,37169795,37169812,37160826,37163128,43021184,43021340,43021183,43021185,46269742,46270123,43021971,43021186,37310287,42536586,42710028,40484119,42539567,37168895,42538263,46284320,46287153,37160941,37160966,37169539,37161131,37161114,40484176,45768974,37161124,37161167,37162501,37161136,37169814,45773026,45769871,37309701,37309700,44782546,44813345,45766547,45766552,42709771,37311903,45757792,37161108,37311902,45757692,45757260,37396178,44784303,37311939,37161129,42538804,43530820,40480487,37160673,37161447,45769834,45769836,45771079,45767599,45763907,42534909,42534906,42534904,42534902,42534908,45763906,37174069,37174070,42534910,42534905,42534903,42534901,42534907,40483376,46269769,46269705,46269706,37310254,44784135,37161132,37167313,37167312,37160669,40493465,37164502,45757703,45757702,37164729,45772117,42536621,37161122,37161134,37160432,37164711,46270013,37160667,37164708,40480261,46269729,42536560,42539540,42536559,45757421,44783580,40482954,43021194,43021289,46270132,37172861,37172860,42536745,37161477,45757261,46272753,37161135,46269700,37169818,45757206,46269954,40481839,40482061,46270121,46270318,46270027,46274035,37163210,45768961,45768960,45771022,40479642,40480033,40481335,40487853,40487854,42537252,42537251,37165171,44784428,44784427,44784429,44782823,44782483,43530646,37161475,37165748,44784136,37164683,44784476,37311893,37167303,37174491,37164724,44784567,44784295,40491451,44782822,37165982,43530637,45757263,40274283,43021785,43021781,43021783,43021782,43021786,40493189,37167513,37160824,45757264,37161518,37161519,37161153,37161173,37162518,37162517,42536541,37160703,45757605,40383286,37161105,46269748,37169576,37161166,42535233,45757155,45757156,37397561,37171002,37171003,37171005,37171006,37171007,37171008,37171009,42536672,42536673,45772996,40488872,45773146,40480902,42534820,45769465,44784423,37312146,37169724,37169725,44810378,37162668,37163417,37163419,40491473,37204366,44782989,42537537,46284902,40490351,40490814,37168291,37168284,37168275,37168282,37168271,37168279,37168270,37168286,37168289,37168277,37168075,37396003,37160668,45771090,37160665,37160666,37170169,37161962,37161265,37161432,37162035,37161299,37169420,37161815,37161321,37169448,37161821,37162037,37161322,37161898,37161323,37171234,37161324,37161777,37169226,37161819,37161230,37209379,37163135,37161297,37311514,45757150,45770900,37161537,37160722,37160723,37160720,45757268,37167336,37167335,37163567,37163546,37161141,37161174,37161152,45769411,40487062,42538750,40487063,40486631,40489979,37162933,40486629,46269944,40487617,40489980,46269946,40486058,40487064,44784138,40493038,40486059,40487662,42539372,40486685,46270051,40491960,46270052,37168933,40491961,40493039,40493415,40487059,40489907,40489908,40489909,40489910,40489912,40487616,40489913,46269807,40491523,45757198,45768767,37167232,37167199,44782630,42536690,42536689,46270041,37164410,44784137,44782631,37312594,40481852,46270042,46270043,46273475,46270063,46270044,46270048,46270045,46270046,46270047,46274080,46269938,46269939,46269940,46269941,46269942,46269943,37167160,37167159,45757143,45768730,37396171,37394658,45772080,37160718,37162503,37162502,37160721,37160719,37162505,37162504,37160717,37162507,37162506,37160715,37162509,37162508,37161142,40486417,37161163,37161157,44808741,37161171,37161143,37161175,44808743,37161165,37160851,37160670,37203790,40482438,40493509,46273402,37312585,40490857,37162042,37162041,37161329,37161335,43530818,42709770,40491492,45772107,37161553,37311807,42534938,46271527,46273632,45769864,43531586,45757152,42537335,45757696,37161172,37161128,46273126,43021833,37161121,37167306,37167307,37161140,46270059,46270058,37160849,45757694,45772095,45757273,45768962,37161217,37162034,37162033,37161149,44790688,37311918,37311917,37160854,43021784,45757151,40492320,37161126,37170179,42710053,37312581,37169424,37161115,37312580,37164700,40489337,37161111,37311938,37169423,40532149,40490822,40486464,40492323,40488321,40492396,40490329,37161120,40491859,37160614,37161117,37161138,40492366,37161123,37161130,45757271,40490395,37161088,37311895,42538548,45768910,45768963,45768964,46284901,45768965,46270122,46270491,46273463,46270377,45757595,46269809,46269813,37167394,37167393,37161459,37161486,45757283,37162725,40490394,40491348,40490302,40489357,37162511,37162510,37395593,37169518,37169473,37169519,37169475,45757423,45757153,37161464,43020874,37162414,45768827,45769824,45757141,45757142,37161458,37161456,43021290,37162295,37161089,40481087,37162099,45768771,44806553,46272377,37160804,37160716,37172198,37169603,42709911,4326255,4345795,4281836,4321134,4279752,4263428,4295960,4274787,4325425,4280200,36675193,36716000,4341651,4340503,4325867,4324608,4268754,36713476,36684477,4273250,36685120,4318695,37016126,4311830,4320810,4339469,4317971,36685936,36685937,4278673,4266590,37016127,36685157,36685944,36685948,36685947,36717200,36685168,36685942,36717312,36685951,4323617,4328666,4334321,37159956,4266864,4288876,4295570,37109299,4330371,4336155,4265209,4329088,36685228,36685945,36685949,36685946,36713155,36685239,36685943,36713154,36685950,4341775,4301890,4330174,36715542,4318849,36685940,36685941,36685938,36685939,4331669,4332658,4271572,37109930,4280573,4264653,4342753,4338871,4324540,4267135,4299557,37017285,36715547,4280379,4300233,4298984,4290718,4300232,4293285,4293286,4300234,35625922,37116924,35625926,4267869,4311040,4288676,4310400,4300221,4294548,4329572,36716726,4346171,37017266,36716680,4277609,4334409,37117750,4320492,36716708,4341652,4311158,36685132,36685202,36714565,4271450,36676304,4284564,4301046,4276105,4345444,4345701,4307774,4330644,36685926,36685927,37116457,4271511,36685932,4295722,36685933,4346181,4346180,4337445,4345213,37117202,4347539,4345584,4317283,4345583,37117154,37108666,4341764,4294711,4347538,4280571,4310661,4338889,37116845,37111252,37117932,4340803,4288727,4346045,4346044,4273095,4347434,4329106,4331815,4335728,4341089,4322815,4279774,4301754,4267155,4347426,4278975,36714497,4344166,4345328,4293424,37017282,4267414,4340493,4340964,4268760,4340257,4338362,4302676,4319160,4345358,4290971,37116456,4290720,4299007,4300348,4320828,37110308,4345911,37017132,4300225,4298741,37116451,4294441,4326601,37019055,4318386,4343917,36685016,37108586,37108588,37108584,36685015,37108585,37108587,37108583,36683386,4346054,4320537,37017456,4309106,4327820,4347431,4345459,35621775,4294712,4320034,4345463,36716913,4300122,4345351,4327861,4329095,4331802,4328019,4294444,4335988,4335899,4335876,4319156,4341224,36713241,4263992,4279474,37019058,4294447,4340115,4324904,4303258,4346041,4346179,4271072,4271005,4266836,4294564,4294565,4298868,4291601,36713310,36685078,36685083,36687129,36687204,36685105,36686923,37160030,37108901,4347658,37017585,4325288,36713311,37151507,36713312,37151506,4320340,4318953,4336548,4284824,4345219,4347522,4291604,4295178,4266804,4270886,4269876,4345816,4310674,4272006,4296066,4311704,37017595,37017103,4304550,4345829,4347549,4302073,4263715,4314257,4338890,4331364,37017092,37017254,36714339,4347553,4347659,4346188,4346055,4276198,4263692,4310966,4270206,4296450,37159814,37159841,37159809,37159815,37159837,37159807,37159811,37159831,37159818,4277942,37159813,37159842,37159810,37159816,37159840,37159808,37159812,37159832,37159817,4282319,4275118,4291312,4313133,37017276,4309937,37018059,4287838,35622688,4294696,4289531,4335873,4283087,4267714,4318545,36685954,36685928,36685930,36685956,36685960,36685952,36685962,36685958,4290877,4334404,36685955,36685929,36685931,36685957,36685961,36685953,36685963,36685959,4321868,4299264,4320944,4263898,4305341,4325422,4286497,4345229,4346190,4347655,4345705,4300212,4345573,4296629,4295730,36715951,4345695,4345353,4345205,4344638,4299529,4275415,4294572,4283078,37116455,4330696,4334410,36716727,4346172,36674398,36714236,35625141,35625296,35625295,35625139,35625040,35625140,35624867,35624866,4345462,37017210,4296497,4347433,4345212,4346182,4345708,4269782,4345801,36685142,36685213,36715843,4298987,4346042,4347294,37018432,4318398,37016756,4344375,4344142,37108667,36685047,35609025,4347295,37117198,36685046,35609024,4347296,4299005,4296554,4298986,4298985,37118654,4269363,4266498,4295429,37116690,4345700,4345446,36685147,36685218,4346046,4335729,4269943,4292401,4347430,4307981,4277417,37017453,36717493,36715901,36715899,4274011,4293463,4307867,4304732,4298862,4294552,4294553,36715563,4347546,4337953,4322865,4290195,4345914,4310847,36715220,36712849,4267804,4282159,4346169,4287866,4345447,4345825,4345476,4345457,4296067,4347560,4345223,4347526,4346191,4276193,4345217,4306956,4345226,4346051,4347435,4309525,36717507,36714965,4347290,4299006,4340797,4340962,4330151,4306458,4298473,36716795,37017549,4307791,37116468,4300352,37017294,36716707,36716706,36717149,4320631,4290077,37018935,4299010,4298589,4298588,4270607,4290725,4290724,4290719,4296186,4270608,37018486,4294713,4298587,4270609,36716705,4318116,4345211,4329439,4345703,37017442,4265179,4334113,4283949,4338119,4329093,4304722,36674592,36684304,36683584,37017426,4329092,37018487,4337673,4277745,4307213,4300763,36683502,36683554,37017319,37018711,37017094,36716009,37017260,4332657,37017279,37017244,37017125,37017259,4294570,4297886,37017655,4347525,4345822,4347561,4270604,4300340,4345702,4296064,4298583,4293422,4299004,4294710,4347558,36715992,37019052,37017105,4345233,4346166,4313875,4313631,4312391,4314815,4347534,4293287,4306315,4345820,4294715,4346163,4345475,4293417,4266809,37116441,4345222,37017354,4313871,4340961,37117176,37110319,37110314,37110316,37110318,37110311,37116439,4268929,4347650,35622880,4285805,4300346,4264057,4264760,4268984,4346971,4309954,36715969,36716017,36716014,36715988,4322568,36717188,36715978,4302794,36715986,36716010,36716011,36716013,36716012,36716016,37016847,36716007,37110324,36715357,4270334,4339484,4335453,4335454,4293419,37017265,4345208,4345355,4345206,4347425,4345354,4320933,4345235,4300186,37017220,4262665,4345821,37117751,4302798,4318372,4298555,4312889,4291605,4268039,4345472,37017106,36687131,4300219,36687130,4266323,4289612,4347424,4345802,37018701,4308941,4326661,4308630,36683379,35625611,35625606,35625612,37116426,4345232,4346176,37116831,4308319,4345227,4347555,4281684,36717455,4342876,36717567,36716728,4318555,4346174,4295288,4300344,4345817,4345706,4294706,4314254,37017586,4265858,4297360,4300792,36715876,4274981,4266814,4302462,4274316,4342663,4335890,4338751,4342627,4270197,4344052,4342877,4279304,4279375,4323822,4327172,4263369,4337374,37159805,37159823,37159819,37159825,36685922,37159827,36685924,37159830,37159806,37159824,37159820,37159826,36685923,37159828,36685925,37159829,4277451,4300074,37159821,37159822,4291665,4271838,4345712,4341763,36712963,36717279,4322625,4302958,4347289,4345455,36717606,37110306,36716876,36716872,36716873,4345214,37116450,37017261,4298864,4346178,4347530,4345460,4289620,36674821,37017072,37018199,37017065,37017064,4345915,4347660,4291613,4335889,4342771,4294443,4298859,4301243,4270302,4345830,4298857,4262787,36716636,4345473,4346173,4347548,37017093,4347429,4301601,4263219,4297024,4297537,4298975,37017209,4345464,36676638,4314443,4308946,4345824,36715820,4263363,4345823,4294300,37018885,4347544,4311484,4265441,4265440,4312115,4265859,4307419,4307553,4266196,4265860,36712850,4310159,4314727,37108786,4296460,4276206,4300123,4347524,36713313,37109491,37109492,4314426,4310097,4292368,4297802,4298843,37159342,36715476,4340791,36687122,4347288,4333885,37019108,4313730,36715554,4345574,4267218,4298228,4345224,4345225,4347527,4295589,4310964,4340960,4292087,4324541,37018063,4285453,4297478,4338750,4345796,4298604,4266791,4340497,4343693,4309476,4309922,4309923,4309019,4267739,4274493,4313851,4295732,4306774,4286166,4264169,4299268,4296165,4307939,4274340,4298821,4307650,4274950,4308444,4306148,4327951,4298113,4301103,4268702,4346167,4282313,4270343,4264767,4328509,4323306,4301508,4269346,4292715,4269345,4288624,4303222,4287855,4313800,4263882,4287087,4325118,4294394,4266521,4287394,4264628,4279161,4313564,4290332,4276677,4283957,4327043,4265180,4286020,4304386,4322010,4262543,4266664,4313143,4308593,4312087,4313415,4280804,4289009,4290324,4270071,4295563,4291926,4321380,4274949,4269060,4276806,4330565,4326268,4287851,4336956,4288599,4327334,4282536,4269788,4327646,4264182,4298401,4327197,4327800,4327948,4267131,4322797,4273375,4301108,4338095,4284405,4297893,4345696,4286514,4306277,4265192,4285123,4282937,4283671,4263698,4280058,4264918,4269480,4271439,4307678,4266048,4263876,4297001,4279546,4298676,4288612,4271447,4313986,4265064,4305336,4272172,4285867,4321759,4271180,4282013,4267729,4305182,36685420,36715956,36715946,4309542,4278506,37018841,36715942,37018494,36715949,36715963,36716002,37016869,36716023,36715943,36685414,36685415,36685412,36685413,36715983,36717189,4269236,4279310,36674252,36715984,4265729,4265734,4311426,36715962,37017550,36716003,37017446,4303710,36715936,36715976,37018560,37018503,36715941,36715952,4282310,4321384,36715981,36717498,36715987,37017454,37017457,4289924,4288743,36715967,36715965,36674254,36717185,36715960,36715994,36715980,4329854,4322476,4278236,36715945,36716020,36717504,36715982,36715979,37018492,36715991,37016308,4326837,36716008,37017295,36717502,37018843,36716019,36715961,36685425,37018849,36715998,37017248,36717506,36685491,4328822,36715995,4290068,36715974,36717187,36717186,37019042,36715996,36715990,36715999,36715944,36716018,36675153,36685419,36717499,4307291,37017219,36685503,37017124,36716518,36674253,36716021,36715964,36716022,36715900,36717458,37110327,36715541,36717457,37110325,36715536,37109916,37117203,36715545,36715544,36715561,37109915,37119137,37016724,4309924,4335452,36715822,37116566,36685124,4332640,36715825,4342784,4335369,4331670,4308693,4345338,4308692,4309314,4309003,4309315,36715971,4326841,37160431,36715546,36675191,36715560,4318709,4340124,4317993,4298713,36714243,36716681,4330643,36716001,36717503,36715553,36715548,36715550,36715551,36715549,36715997,37160371,36715939,37116425,36713475,37108657,37108656,4344275,36713206,36685125,4330222,37108658,37017755,36715556,36715970,36715555,37116452,4343460,4327871,4308468,4306831,4328664,36717456,37155922,4347179,37160373,37160430,4322737,37018096,4334028,4327875,36716867,4334027,36715562,36716231,4340936,4340393,4334748,36674273,37017318,4322630,4312861,4309190,4309439,4262590,37017284,37108589,37117135,4334111,4298718,4298715,4291305,4299566,36713513,4340661,4340673,4347180,4336140,4266078,4340263,4340665,4341227,4305661,4273522,4327199,4295712,4298201,4311938,4275579,4321689,4330697,4329031,4308754,4320044,4267719,4324698,4325275,4336246,4297014,4317694,4282314,4296609,4273073,4267582,4291307,4336217,37111320,4310544,37019180,4296070,4347533,4266367,36676221,37016926,36676233,4304374,36714570,36714388,35625600,35625599,35625601,4317273,4318388,4319317,4299794,4340811,37108970,4273378,4347432,4345210,4347646,4344372,4345359,4345479,4270506,4270602,36715993,37116453,37116454,37116830,36717290,35622340,4346187,4262720,4345326,4298421,37017296,4310554,4264201,4288611,37116563,37108969,37108968,4265439,4263853,4346970,4272251,4336251,4265323,4306813,4345916,4346039,4346189,4294554,35622881,4313873,4347536,4300347,4294714,4300883,37155410,4345220,4294558,4342881,37017777,4345216,4341650,4346036,4347654,4297984,4347436,4291612,4347528,4345799,37151377,37019127,35622630,4300416,4339485,37017263,4346040,4304747,4344254,4343344,4263837,4305243,4345810,4342659,36717592,4307072,4296068,4347651,36714255,37017320,4335731,36685099,36685167,36685238,4345456,4347543,4347656,4300760,4327664,4345913,36712828,4347542,4326421,36715957,36717432,36715937,36715953,36715972,36715533,36715532,37017363,37017364,37018724,36715973,36716517,36716516,36715968,36715954,36715989,36715958,36715535,36715534,36717500,36716015,36717501,36716006,4312036,4345454,4310547,4265856,4265857,37017580,4266334,4346185,4345792,4323612,4285746,35625604,35625602,35625605,4345805,4314876,4265742,35623434,35623435,36715815,36716005,4277025,4286510,4297284,4346165,4279940,4275560,4345800,37017652,4307131,4290000,4272028,4327947,4345471,4293420,4294707,4299001,4299002,4300341,4300342,4300343,4299003,4293421,4294708,4294709,37160368,37160370,37159348,37160367,37160366,4300230,4312516,4300231,4294567,4293283,4293284,4298869,4294566,4298871,4298870,4274344,35622800,4318117,4319158,4318118,4318119,4320830,36715537,36715538,36715540,37017126,4299935,37017108,4331309,4316194,4347551,4273470,4346164,36676789,36676785,35622404,4289603,4344053,4298858,36717459,4299275,4298016,4298735,36715568,36717505,4300220,4308585,4301413,4300114,36715567,4298014,4298866,4300465,4300236,4298734,4300653,37017424,4345450,37019034,37017262,4345794,4310991,4345461,4345793,4298988,4286341,4294555,35625919,35625928,35625925,4306672,4309568,37152653,36716495,4323428,4308445,4300986,4305176,4310683,37017654,4345239,4303372,4346048,4346186,4334134,4345828,4346184,4346183,4346047,4300337,4293411,4298999,4293412,4285438,4293413,4300339,4299000,4293415,4293416,4300338,4298996,4293401,4294580,4293402,4293403,4296069,36674803,4293292,37017579,4300224,4291602,4265753,4327965,37017249,4347537,4270203,4327862,4317282,4314693,37108668,37108669,37016751,36685174,36685245,36715948,4295260,35610376,4267887,4347648,4346177,4274802,4312196,4300988,4347531,4305155,4345693,36715902,36715878,36715539,37116438,37117749,36715552,37117748,4264727,4341774,37116460,36716523,36716524,36676420,36676418,36676419,4345236,4345449,36715428,4268842,4306683,4294556,4300215,36716700,4269881,4277121,36716865,37017557,37017566,37019087,4345797,4308123,4321588,4341362,4320032,4346161,4346175,36715818,4268846,4346162,4340258,36713514,4341541,4300349,4290758,4294404,4306632,4318836,4265393,4297292,37119233,37116366,4299862,37016927,36676238,4346038,4347649,36716729,37018721,4345819,4347535,4285156,4309339,4308715,4265769,36683380,4308542,4308837,36712819,36712821,36712818,36712826,37017247,37116927,37116925,37118756,37116909,37116908,37117785,37116907,37116933,4347545,37017112,4347532,4298983,4346160,37018062,4294437,4294436,4298850,4300208,4294438,37116928,37116926,37116915,37118758,37116916,37116914,37117787,37116932,4298849,4324751,37116642,37017246,4300218,4308690,4342900,4293433,4338870,36715504,4341225,4266366,4345572,4342629,4293418,4320033,4291610,4294442,4291609,37155413,4279550,35622432,4345699,4345215,4324261,36685934,36685935,4306076,4348434,4319015,4309214,4293282,4269558,4270603,36715559,4288479,36715557,4266028,4312595,4328373,37017455,4324412,4320031,4347541,4347540,4345234,37018714,4345803,36685421,4334649,4323342,37017277,37017278,37160069,4291608,4291597,4291634,37016140,4300209,4298851,4300210,4300211,4298852,36685195,36685194,4307400,4275588,37018755,36685193,4274502,37017425,37017217,37017243,4300121,4346168,4300216,4312144,4262939,4345238,4273323,4275129,4338888,4264888,4318538,4291598,4317147,4317956,4317146,4316875,4288241,4347552,4345327,4347661,4346170,4345478,4307214,4344609,4280726,37116931,37116929,37117786,37116913,37116912,37116910,37116911,37116935,4317957,4316072,4316073,37118759,37116930,37118757,37116920,37116919,37116917,37116918,35608165,4297450,4274335,4311929,4268187,4345808,37018499,37016131,37018498,36715806,36674642,36684427,36715430,37116435,4279922,37016160,4345360,4345445,36714927,4346049,4302049,36716406,36715817,36715819,36715821,4298474,37018563,36715408,4265526,36715959,36715947,4345710,4345453,4343239,4345352,4320030,4345448,4347653,4293423,4326735,4299009,4270778,4347562,37017082,4287930,37016908,4319157,4294446,4298015,4305659,4345458,36687211,4300222,4327065,4291611,4280375,4301412,4309800,4321232,4345713,4345912,4346052,37017071,36716709,4284844,37109010,37117085,4345831,4345827,4346192,4314115,4347559,4293901,4345231,4345474,36715558,4322161,4295714,4301239,4298475,36675187,36675189,4289018,4317256,4299783,4328820,37108635,37108634,4341082,4334801,4305948,4345477,4345694,4291175,4298861,4294449,4294448,4298860,4273876,4300223,4265210,4270605,37155424,4318242,4276663,4346056,4337136,4345230,4347529,4288166,4345798,4347652,4321597,4294573,4300324,4300325,4293288,4294574,4294575,4293289,4298991,4300326,4294576,4300329,4293404,4293405,4294581,4294582,4293406,4293408,4298998,4300332,4300330,4298997,4294583,4300331,4294585,4293407,4293409,4293410,4300333,4294586,4294700,4294701,4300334,4328226,4298992,4298993,4300327,4305732,4298994,4310539,4300328,4300335,4294703,4294841,4294578,4298995,4293290,4312636,4294704,4345357,36717219,4334873,4345575,4345707,4344373,37109715,4323204,4298584,4300336,4345812,4290721,4324130,4345697,4304867,4308280,4264207,4282614,4310093,4339400,4310580,37160413,4266861,4273555,4341241,4311948,4290623,36713392,4275434,4347523,4345704,4281232,37155412,37155414,4338816,4337280,4347556,37018496,4270705,35610224,4280213,4345451,4311853,37016368,37016369,37016370,4326427,4344371,4345815,36687174,36687176,36687175,4291596,4288372,36715475,4305500,4345691,4345207,4291655,4345714,4345711,4306509,4300228,4341765,4343916,37160414,4334746,4333979,37160412,4321233,4340113,36712667,4345692,4347554,4291005,4313600,37151819,4287644,36685118,4344370,4344051,4289908,4334872,37160396,4278083,4341228,4291600,4294439,4300214,4294440,4314427,37017283,35623148,4294557,4291603,36716496,4296065,4265176,36716559,37108761,4343215,4345918,4344398,4347423,4308864,4171019,4144821,4187789,4194534,4166856,4170853,4170873,4246509,4193895,4247926,4173737,4223376,4200237,4260374,4179538,4176918,4214610,4240848,4227091,4205810,4202317,4134124,4153106,4215034,4227089,4203417,4228164,4202232,4227090,4212378,4200968,4219324,4217977,4244743,4160180,4185086,4200967,4239657,4140224,4137285,4161538,4195436,4140451,4248277,4137358,4237227,4248555,4151131,4144386,4220992,4188049,4154088,4236722,4166998,4208815,4262542,4222003,4203928,4124366,4218688,4250317,4180574,4262258,4147598,4242875,4237169,4245384,4174108,4151150,4180887,4137468,4149198,4237168,4185886,4141589,4211516,4176868,4142902,4238530,4151763,4213413,4196973,4218406,4260680,4128060,4221489,4141483,4145477,4183170,4160211,4186276,4137121,4130333,4141802,4248859,4229623,4147376,4147586,4136355,4221266,4141626,4137452,4123729,4128401,4237741,4138077,4222405,4260842,4239213,4138475,4138450,4213204,4161830,4253010,4168792,4230249,4208807,4144035,4147631,4121476,4208810,4142570,4227902,4134144,4171532,4146111,4148301,4163133,4151696,4124510,4123593,4138536,4121601,4215452,4173734,4130331,4241411,4241693,4251796,4252713,4154923,4194509,4158412,4160643,4198123,4252853,4211974,4200018,4165259,4123728,4129363,4240452,4210628,4151001,4236903,4228934,4224553,4202663,4182576,4173717,4249128,4126945,4200244,4165550,4160365,4188108,4138257,4193635,4203326,4168151,4187858,4148713,4160185,4187771,4225810,4240364,4120944,4201627,4186114,4120323,4248154,4195452,4203846,4241530,4239722,4174693,4121788,4145538,4237587,4166768,4179072,4206696,4161245,4167984,4196020,4197765,4201074,4127724,4208663,4184048,4175166,4193870,4187784,4163900,4167082,4193166,4208665,4215457,4193874,4208661,4193869,4151000,4208662,4193873,4193168,4124694,4250335,4223032,4207184,4207185,4208664,4193167,4240301,4120798,4121792,4169249,4259502,4189300,4141201,4226533,4138769,4245006,4236311,4224405,4231974,4226790,4227430,4218647,4220827,4144542,4243179,4182992,4165045,4135210,4149572,4228701,4165895,4233684,4195396,4200680,4201258,4150064,4143494,4260329,4249130,4219870,4162546,4196997,4170235,4231975,4186741,4194804,4153233,4195315,4152487,4213372,4227854,4171563,4150302,4186870,4199600,4231181,4145478,4230383,4147134,4217669,4201197,4130341,4222062,4142836,4226792,4143545,4172458,4250188,4149507,4212079,4169102,4216263,4188998,4178125,4169234,4261626,4199541,4219067,4195575,4234232,4186603,4145588,4230505,4238684,4199152,4201700,4208673,4132149,4246729,4146492,4232472,4185364,4146462,4150176,4146236,4246395,4186208,4245143,4243343,4200502,4189011,4228503,4210482,4180079,4179335,4147453,4175965,4206425,4130215,4215822,4208980,4244370,4226110,4223276,4203913,4191951,4228674,4195876,4123299,4247297,4202367,4199268,4204238,4261688,4215164,4234127,4227344,4127725,4130345,4127403,4127731,4237648,4245641,4128394,4130332,4126282,4127408,4213641,4239468,4136065,4249743,4135051,4237837,4173584,4232466,4234876,4214524,4186202,4216848,4122212,4163680,4127563,4125952,4172431,4177850,4120259,4120634,4126297,4122186,4244060,4196998,4230641,4127391,4247138,4221767,4248099,4124985,4147135,4136973,4186902,4230386,4173333,4211252,4237773,4224740,4165240,4168135,4173342,4262367,4234500,4164483,4129543,4175989,4239550,4171124,4124998,4180644,4174309,4174301,4173337,4132902,4239065,4180254,4171125,4173336,4220675,4195112,4197823,4188480,4167920,4203916,4241576,4242126,4251491,4173980,4173334,4244873,4174308,4234882,4244336,4231740,4158330,4151455,4141045,4208814,4235552,4187049,4237774,4217228,4215673,4220924,4219534,4261538,4221187,4222712,4228936,4227968,4212782,4166372,4248442,4168345,4153658,4214003,4164928,4247613,4176285,4203790,4207359,4144320,4179507,4237775,4128374,4172951,4211924,4220644,4170869,4228133,4159143,4252864,4249570,4256238,4249692,4260196,4224285,4239344,4227229,4242116,4124542,4162530,4221995,4230586,4216629,4246652,4190884,4249437,4248519,4220009,4140077,4232906,4248517,4126523,4212883,4225726,4253157,4252534,4253013,4161193,4248801,4230390,4251454,4260331,4251065,4257545,4208705,4236143,4189153,4248392,4147672,4253153,4141426,4261826,4234501,4211682,4248510,4197271,4168470,4141878,4176734,4261486,4227380,4224517,4177199,4237639,4205455,4139537,4154415,4142991,4237813,4134562,4260535,4226022,4215751,4218955,4188221,4228754,4221064,4221192,4153303,4237776,4228937,4179205,4250891,4125953,4125951,4146943,4221661,4217555,4222250,4220014,4228612,4228440,4207472,4155957,4157158,4216631,4252862,4233054,4231977,4210015,4162380,4217187,4237777,4167058,4248364,4249135,4157531,4190113,4190114,4251459,4224789,4138760,4185105,4193784,4231895,4187905,4134613,4228272,4171285,4122213,4221911,4177554,4193122,4249735,4193182,4129391,4177636,4171253,4141062,4164645,4188028,4256129,4249540,4252717,4249541,4177358,4161947,4127735,4157481,4193175,4230371,4230369,4193987,4213114,4207159,4207191,4165570,4149910,4152070,4208780,4121473,4193174,4229422,4220002,4238732,4169415,4247171,4185761,4136096,4163393,4146982,4200994,4235280,4252755,4148099,4141477,4142821,4141478,4142822,4224577,4235380,4172956,4193988,4148102,4180294,4156057,4128047,4231978,4144034,4128042,4127390,4201692,4127392,4128399,4128397,4176270,4175505,4262261,4152340,4158329,4170296,4174839,4218123,4211821,4249136,4242412,4164792,4249017,4240481,4218010,4141481,4248809,4248807,4256893,4248810,4256894,4256895,4252538,4252539,4237184,4248811,4146776,4232623,4232767,4222402,4129544,4151502,4260189,4243356,4236011,4222224,4164216,4253626,4140602,4218443,4146439,4234499,4251448,4218348,4237778,4253627,4174699,4171706,4211951,4124508,4139215,4174405,4224242,4172489,4227539,4218900,4221343,4175535,4189358,4241223,4249138,4225170,4172009,4143092,4236356,4161950,4262297,4253472,4134999,4220916,4143379,4256470,4120623,4184052,4183270,4120937,4228760,4260205,4184459,4120938,4135197,4148098,4160460,4230388,4122775,4125017,4249564,4209134,4218201,4228316,4146457,4144026,4144947,4144027,4146008,4144929,4144028,4121455,4159754,4153371,4167926,4139576,4146009,4146010,4130006,4227845,4139574,4139575,4152959,4155027,4152958,4181310,4152955,4151521,4152957,4155028,4152956,4151520,4138771,4122769,4227092,4173778,4126296,4153568,4193160,4224925,4147859,4258835,4197962,4201413,4252888,4208235,4146057,4234098,4246738,4211254,4177014,4216189,4207220,4168922,4185049,4188340,4222308,4197573,4250778,4209730,4166404,4174036,4238591,4187684,4246783,4195293,4209560,4165673,4241589,4149034,4244392,4174673,4231566,4175957,4163695,4143298,4181930,4155642,4211400,4195282,4243209,4195254,4179087,4198064,4239960,4185514,4235593,4172942,4148289,4214565,4206792,4254240,4241110,4239244,4142059,4195841,4189372,4250492,4213057,4239075,4204056,4244062,4134590,4225267,4195889,4167987,4169763,4231314,4242537,4172054,4261809,4254078,4244591,4136092,4179978,4190572,4179923,4207658,4167833,4242133,4196059,4221863,4243833,4216034,4224622,4197405,4231437,4165385,4147051,4147918,4238532,4215769,4185262,4196475,4173733,4238329,4174196,4142897,4149849,4240598,4218044,4212111,4232002,4226039,4222165,4146211,4221606,4207669,4198995,4248408,4220078,4216373,4194498,4224340,4135930,4219014,4233507,4143623,4193383,4219698,4219549,4231420,4168009,4174213,4260692,4148952,4146491,4241720,4252745,4143331,4236913,4234839,4203773,4139142,4245023,4222474,4140673,4190709,4246872,4202675,4176587,4226430,4124241,4136772,4235604,4218536,4232168,4165102,4234399,4250906,4173587,4179200,4233831,4224634,4242883,4173601,4219328,4184806,4148089,4228835,4155853,4240237,4180408,4243924,4219905,4172177,4185731,4180415,4251183,4225596,4195743,4207228,4184137,4228047,4163952,4228502,4214038,4248137,4216714,4224487,4210050,4138390,4262131,4219206,4206167,4186757,4186292,4252571,4237814,4245505,4238520,4170386,4219564,4223451,4240721,4252757,4218127,4206912,4189039,4149432,4147069,4147836,4214436,4253035,4200232,4249827,4249828,4253016,4187723,4158421,4188419,4158422,4188420,4158423,4160647,4187724,4188421,4188423,4187725,4158424,4158425,4158420,4158426,4160648,4188425,4187726,4188426,4160649,4158427,4188427,4187727,4158428,4188524,4158429,4160650,4158430,4187728,4187729,4188526,4160651,4187730,4188527,4241454,4176611,4135020,4231708,4186912,4219368,4137996,4194365,4143956,4260333,4253017,4257548,4237785,4249258,4223946,4145763,4185509,4248511,4147524,4238545,4228113,4158561,4158431,4160652,4160653,4188528,4160654,4158432,4160491,4187745,4154414,4160655,4162285,4188529,4188530,4187731,4239616,4158433,4158546,4187732,4187733,4158547,4188531,4187734,4160656,4160657,4160658,4247296,4160660,4188532,4188411,4187735,4158548,4160642,4187606,4158549,4158550,4187736,4158551,4158552,4190193,4160767,4187737,4187738,4160768,4187607,4162286,4188533,4160769,4160770,4160771,4158553,4160772,4158554,4188534,4162435,4158555,4187739,4188535,4187740,4160773,4188536,4187741,4158556,4188537,4187743,4188541,4187744,4160776,4160777,4160778,4188542,4160779,4188543,4162434,4158562,4158559,4223818,4160659,4231983,4224822,4188422,4249254,4160608,4187609,4187611,4188414,4187713,4158414,4158415,4188415,4187715,4187716,4160644,4187717,4158416,4187718,4158417,4187719,4188416,4188417,4188418,4158418,4158419,4187720,4187721,4158413,4160646,4187722,4122425,4237786,4177997,4188614,4187610,4167063,4231986,4249134,4228938,4229404,4231988,4231991,4231992,4232111,4232112,4249262,4176170,4121639,4180166,4206126,4208813,4150539,4129349,4193990,4171406,4149606,4173813,4205814,4180599,4154121,4201370,4174406,4127737,4193187,4198758,4161377,4159655,4200518,4181811,4192561,4134887,4134889,4133002,4122755,4128849,4124677,4178815,4178816,4180167,4176943,4180168,4134592,4121450,4214438,4214437,4207688,4225989,4178155,4193989,4217075,4178817,4148556,4194154,4177365,4180873,4228290,4204188,4194004,4231827,4127562,4120327,4176944,4207310,4207308,4207471,4207307,4208785,4208784,4193318,4198126,4132637,4207309,4132493,4127406,4208783,4177333,4177351,4222537,4177968,4211969,4183568,4247539,4188492,4195004,4261682,4182905,4190504,4181737,4148680,4246417,4207808,4197933,4184990,4172013,4190810,4201299,4175129,4245010,4199161,4233520,4183276,4226240,4248261,4242202,4196922,4207834,4182896,4246201,4248849,4245022,4218445,4262365,4163700,4251925,4206776,4170389,4243001,4241352,4141602,4253504,4190320,4196516,4185419,4194658,4174041,4149090,4243362,4196816,4220649,4214807,4252885,4183609,4186568,4146757,4241445,4151099,4256128,4137441,4177555,4224410,4214519,4214520,4222383,4212089,4120955,4261331,4120316,4139561,4243187,4249259,4228941,4228943,4178772,4228942,4249260,4231979,4137770,4237787,4231990,4158332,4198045,4185933,4154124,4213514,4227852,4190518,4224096,4175483,4163288,4199911,4251485,4230601,4150808,4174511,4141484,4236862,4238829,4217799,4222587,4198049,4189317,4231980,4213460,4194786,4227576,4145369,4237780,4136344,4238207,4133224,4200530,4186238,4127282,4228757,4175297,4220328,4141757,4259503,4252045,4252044,4185890,4227135,4225027,4127711,4164214,4207302,4195622,4226357,4204393,4143214,4239702,4166858,4155178,4249253,4135713,4260074,4224298,4223325,4221366,4223324,4224297,4230602,4223323,4180433,4137771,4171497,4225193,4194973,4124362,4146581,4163969,4238336,4207180,4246422,4234275,4145549,4183461,4168202,4176302,4207121,4122223,4232793,4127733,4220632,4218126,4248576,4193176,4257827,4231982,4137384,4221607,4218993,4246882,4150781,4121631,4166042,4220389,4221396,4196524,4227974,4224078,4227053,4237781,4236144,4246664,4170142,4221483,4218457,4136809,4245453,4199942,4171248,4186404,4171247,4171249,4154989,4129185,4173341,4174306,4146848,4153569,4150804,4153570,4234748,4128053,4132505,4174302,4134142,4171126,4171250,4251168,4228745,4227519,4169939,4169927,4219689,4214943,4215383,4261629,4211956,4130007,4224578,4174281,4223738,4141509,4171380,4171058,4221875,4219819,4178891,4210750,4140541,4213341,4183151,4198074,4246106,4195716,4148533,4149402,4187237,4262214,4165897,4201764,4227077,4167196,4220779,4220147,4132494,4166559,4121790,4215978,4214944,4209896,4173259,4247535,4126929,4122209,4170116,4124509,4122211,4122759,4122756,4171217,4122760,4123592,4227205,4224860,4162531,4217969,4188624,4216967,4151843,4155787,4180713,4120945,4177944,4146838,4193918,4244268,4212465,4234762,4230365,4140536,4208812,4237782,4232184,4140832,4231984,4166560,4236860,4148108,4199309,4155530,4223206,4142837,4145073,4142828,4205578,4223380,4146935,4174303,4185025,4241157,4216208,4126450,4128368,4198021,4182586,4204701,4248002,4175960,4228368,4197879,4165681,4187751,4201010,4247528,4245499,4233924,4139430,4141619,4221503,4190647,4226502,4256236,4193964,4137435,4166072,4228277,4139769,4254769,4226662,4138403,4217177,4151978,4153877,4153356,4143888,4259505,4253622,4200891,4237450,4195936,4153361,4215521,4216883,4224240,4176017,4197239,4249132,4165265,4227969,4122757,4183997,4151215,4228821,4120303,4151918,4226631,4195993,4234550,4209274,4213657,4173660,4121469,4120315,4230954,4182558,4145468,4150734,4138244,4245409,4178450,4142174,4250160,4243567,4166057,4216286,4166519,4147680,4159369,4204843,4179524,4190328,4188413,4173094,4230796,4174994,4141120,4213772,4252714,4260073,4256125,4259297,4197677,4143963,4227072,4124353,4152339,4145475,4180072,4223976,4236774,4200014,4137361,4235833,4235834,4122758,4183882,4238508,4142194,4157002,4192381,4225643,4237921,4195736,4218289,4150370,4170143,4176567,4226388,4223918,4228115,4178397,4119954,4217386,4141202,4213917,4217389,4164218,4213393,4226629,4225017,4235289,4207366,4245526,4126284,4127709,4128398,4179775,4220997,4149700,4204819,4131056,4146719,4143493,4215747,4189211,4200072,4218560,4182201,4159752,4186827,4176730,4231390,4197963,4235812,4121335,4193914,4218919,4234860,4202227,4119932,4141296,4155986,4224566,4220603,4254256,4227853,4180772,4188437,4150060,4220074,4149687,4143334,4197927,4158331,4132764,4248877,4123733,4140548,4221118,4174307,4150982,4162402,4159644,4196870,4217694,4201438,4225421,4159863,4212727,4130343,4143698,4236861,4228317,4231989,4120302,4215083,4223597,4222717,4249899,4227350,4243832,4224425,4174198,4129207,4155635,4199144,4216391,4205437,4142120,4130721,4168057,4173075,4220824,4185528,4170730,4224480,4146602,4190297,4149600,4185273,4136660,4214982,4218013,4168461,4219409,4175003,4188412,4162277,4220386,4168285,4223656,4240728,4172657,4170737,4240733,4261611,4177963,4176161,4121325,4124848,4189522,4219047,4195054,4122210,4185826,4122751,4126928,4260509,4259500,4160083,4163425,4201172,4185908,4171523,4254652,4145480,4149102,4177345,4183737,4196116,4127721,4247430,4201436,4226905,4193319,4121789,4163426,4183059,4174374,4188361,4204375,4182398,4185834,4225882,4225881,4222588,4224271,4222419,4222420,4222421,4224272,4220840,4212705,4159648,4224968,4222590,4196813,4222423,4225883,4222424,4225997,4222592,4224273,4224274,4222593,4222591,4225998,4222426,4224275,4226000,4222594,4222595,4226001,4226002,4222596,4222428,4160328,4133972,4167083,4222430,4226003,4222431,4222597,4226004,4163280,4183870,4193183,4138974,4221087,4148121,4218659,4218022,4225690,4237789,4215212,4213380,4193164,4212083,4211820,4210034,4154698,4243806,4150475,4153140,4154468,4154476,4156796,4154467,4150476,4156795,4153135,4150468,4156802,4150477,4150490,4153136,4156797,4156801,4154355,4168058,4150486,4156794,4150487,4153139,4154482,4156669,4150478,4153130,4156670,4154475,4170125,4150481,4154474,4154483,4153142,4153128,4156799,4150480,4150479,4154479,4176556,4130344,4176094,4141063,4178149,4145952,4214988,4215150,4130374,4234563,4200644,4203012,4207953,4200662,4251772,4244573,4244525,4219077,4203768,4209565,4171577,4251787,4153291,4244239,4224748,4144953,4226658,4260661,4124676,4173266,4174680,4238921,4261372,4127732,4224176,4193385,4150516,4239485,4195759,4218612,4127558,4121541,4126283,4198121,4239651,4177206,4160607,4195600,4192846,4260546,4212120,4181583,4148262,4145196,4196799,4128400,4146482,4167561,4127398,4256465,4129541,4233538,4206579,4120281,4167086,4220454,4234757,4226128,4170621,4249876,4202370,4201753,4178008,4181150,4207188,4193983,4208666,4188688,4223947,4193875,4210876,4207187,4207189,4231274,4173818,4198127,4225318,4193169,4186465,4198240,4129542,4130346,4134875,4182728,4215115,4235792,4154776,4138396,4135568,4214984,4051521,4009313,4052511,4056587,4030964,4058352,4001323,4081995,4055120,4029776,4078384,4001158,4049120,4001625,4002803,4001122,4002804,4001119,4001118,4001621,4001159,3654676,4062267,4031464,4061734,4032858,4052222,4006694,4032859,3654678,4059177,4097846,4061735,4025164,4025165,4003511,4003662,4012403,4001010,3654698,4048177,4006970,4032860,4034177,3654699,4003664,4032271,3654696,4025347,4030974,4057063,3654697,3656955,3656871,4100659,4067086,4078227,4033313,3654694,3654695,3654692,3654693,3654691,3654689,4056913,4003016,4055874,4064507,4030976,4006957,4031124,4046505,4001117,4001116,4003139,4002801,4001115,4116325,4003138,4030975,4010825,4009031,4003668,4033885,4080592,4031503,4031817,4058702,4034225,4090695,4041676,4034008,4088233,4105195,4087897,4112822,4056172,4077219,4042741,4057173,4034000,4105409,4009042,3657767,3657768,4085622,4090674,4033150,4057524,4077425,4049964,4009624,4050381,4061917,4112006,4112345,4052545,4110023,4112521,3661405,4048517,4081907,4030982,4082034,4089976,4052542,4103128,4110483,4055494,4080747,4080459,4110485,4025318,4078071,4027854,4108800,4107240,4033947,4066421,4001819,3657864,4048187,4049232,4008081,3655976,4049238,4094226,4115044,4034672,3661748,4110475,4063919,4063918,4066373,4061728,4058590,4108685,4090689,4087419,4110481,4051332,4111089,4111403,4108226,4111091,4108810,4108227,4049458,4009332,4056198,4001283,4003293,4001812,4003168,4001281,4118015,4032851,4001282,4002826,4032852,4115172,4001280,4001499,4001498,4003294,4001284,4032855,4001817,4001816,4003296,4002824,4001814,4001815,4032853,4002827,4032854,4001813,4001818,4002825,4031120,4112359,4091330,4088245,4090828,4087441,4060950,4108223,4056204,4051492,4112358,4112011,4111080,4112007,4110360,4082065,4093475,4087776,4112357,4002336,4103288,4056023,3661406,4112341,4110484,4111400,4109894,4112346,4112015,4111081,4109899,4026158,4102064,4080186,4111090,4108798,4048016,4103588,4108799,4042397,4098652,4052544,4052543,4047619,4112343,4110361,4047628,4100954,4045589,4008725,4033925,4080434,4084205,4084328,4083836,4084015,4082038,4097678,4045979,4051447,3654672,4043916,4032273,4006304,4084948,4029483,4004895,4080452,4093145,4116193,4080771,4048667,4101583,4102195,4031470,4091711,4092158,4070038,3654667,4008978,4098128,4014884,3662381,4080776,4084950,4008721,4050869,4090203,4080604,4028254,4045977,4116649,4027415,4094504,4027381,4029812,4029803,4044349,4029831,3655650,4083920,4026017,4055212,4000938,3655665,4047473,4081581,4085106,4116487,4031473,4030986,4081394,4001025,4082046,3657971,3657769,3662325,3657775,3662335,3657840,3662328,3662329,4108522,4086665,4093474,4056173,4047816,4061822,4066172,4045598,4043896,4026970,4025120,4063812,4066361,4065984,4065988,4029504,4080184,4082039,4080308,4048810,4046074,4056769,4001955,4001957,4001287,4001288,4001956,4068619,4048718,4082033,4009928,4084816,4034818,4084966,4030508,4032428,4043897,4087773,4059733,4080745,4053033,4082051,4032454,4092838,4034439,4084561,4107054,4063806,4069115,4063807,4065976,4077307,4028236,4061712,4001887,4067383,4061215,4065977,4042997,4099596,4101401,4031037,4061052,4080756,3656667,4033146,4032722,4033973,4058234,4063818,4066720,4063910,4061719,4065998,4066369,4063817,4061720,4065991,4066717,4066367,4063906,4063914,4061722,4061723,4066371,4066718,4063909,4065996,4061717,4066370,4065999,4066719,4085268,4023773,4003007,4001160,4009176,4080188,4065997,4100662,4025485,4028237,4061725,4117877,4030220,4100945,4032730,4117685,4028238,4031752,4028202,4113790,4001520,4003011,4032272,4031131,4080916,4032338,4095399,4030977,4006320,4047781,4003020,4003017,4033181,4001661,4034708,4087725,4084794,4086667,4082058,4089362,4043898,4041677,4047632,4094393,4089977,4087745,4080614,4082036,4080440,4081905,4080424,4081906,4085108,4110510,4009926,4032266,4032591,4096951,4034002,4021397,3662319,3662320,3662318,3662321,3662322,4009177,4001011,4001497,4009793,4032877,4033618,4119770,4084958,4081387,4080590,4024670,4082057,4084969,4082064,4047470,4025319,4056319,4049243,4048087,4042511,4100967,4102614,3654685,3654682,4029886,4073287,3655125,3654680,4119595,4110027,4080455,4060944,4110056,4002829,4001954,4117697,4033308,4117698,4001820,4001675,4001015,4031123,4001286,4033843,4031122,4003299,4033309,4110669,4104060,4061733,4048188,4084973,4080753,4096917,4056781,4056597,4032856,4032857,4001014,4001012,4033844,4033311,4033312,4033310,4056768,4044594,4056622,4047623,4012113,3654910,4109099,4081259,4081384,4080750,4080748,4080749,4080460,4084971,3654909,4080609,4101109,4048273,4000061,4082062,4085602,4032359,4034011,4116490,3654916,4079152,4048518,4048519,4070540,4048148,4080880,4048147,4071611,4048593,4106177,4080619,4080879,4048149,4071610,4078519,4100817,4080886,4048592,3654936,3656668,4085105,4080540,4084822,4081393,4048098,4088369,4084819,4084818,4026135,3655293,4029186,4082833,4031474,4092819,4008084,4087893,4080309,4080755,4081390,4082061,4031472,4084970,4093893,4112870,4080781,4080751,4023597,4040475,4080607,4080754,4080617,3654911,3654905,4092992,4090105,4036612,4092685,3654903,3654904,3654902,3654901,4005648,4085107,4109129,4049502,4103655,4033969,4033970,4032719,4032718,4032731,3662327,4032807,4081582,3654918,3654890,4085104,3654889,4080312,4080744,4084962,4080611,4049424,4031117,4080330,4088228,4048032,4030598,4089500,4022811,4022828,4022813,4022219,4008087,4024887,4022815,4023320,4022810,4022826,4022825,4023329,4023321,4021473,4001990,4100065,4022817,4021476,4021478,4024885,4022216,4022822,4024889,4022218,4022819,4025022,4021475,4022209,4022208,4022212,4056753,4028865,4009927,4022215,4021469,4022210,4025021,4021596,4023324,4021595,4091650,4022221,4022220,4025023,4023322,4021474,4006538,4021472,4022820,4021477,4021599,4022214,4023319,4022207,4023326,4022812,4058569,4022827,4021465,4021467,4021601,4022226,4107062,4087290,4022821,4023323,4022818,4022222,4022213,4022224,4058063,4025020,4022823,4022816,4022223,4021597,4022211,4021600,4021470,4021468,4048485,4092667,4084571,4084974,4092851,4082066,4080752,4084978,3654893,4029319,4066257,4080606,4085111,4089506,4084982,4112387,4081910,4082027,4087627,3663214,3663212,3663213,4032781,3656669,4089980,4080427,4089985,4047476,4084954,4093485,4070328,3654806,4030844,4079092,3654948,3654950,3654900,3654898,3655327,3655291,3655324,3655325,4088249,3655305,3655306,3655275,4111084,4111401,3655301,4068478,4041669,4033929,3655330,4032555,4088248,4078931,4105333,4043895,3655351,4102125,4119142,4116849,3655328,4004319,4032277,4071725,4100103,3661791,3661790,4084979,4090680,4008094,4113055,4073090,4045400,4086664,4080454,4082056,4082055,4062474,4028725,4061217,4090458,4056324,4056331,3661885,4094001,4086666,4103893,4089504,4084815,4061716,4034001,4046011,4048676,4058528,4025681,4094965,4047478,4047625,4105474,4027382,4082050,4030507,3655345,4049965,3655666,4041668,4106878,4068162,4071026,4102161,4094087,4078359,4104821,4056330,4111105,4030984,4087597,4032139,4088237,4090704,4091324,4090703,4091325,4090700,4087434,4090701,4087435,4090702,3655346,3655344,4009335,4093480,4080426,4105875,3655326,4029611,4051339,4033982,4051490,4071698,4080594,4081904,4034007,4080340,4059608,4032589,4032590,4080780,4080779,4080596,4080310,4080597,4080341,4056174,4080595,4080778,4034010,4082189,4111261,4080182,4080453,3655300,3655323,3655304,3655343,3655866,3655313,3655863,3655864,3655310,3655308,3655307,3655314,3655311,3655309,4042201,4081580,4084824,4100968,4077608,4033662,4026113,4085853,4111119,4080436,4051335,4087431,4090101,4059294,4055221,4055219,3655317,4033227,4047622,4072340,4051338,4045976,4087449,4092538,4056937,4030750,4084959,4087429,4090095,4087603,4087604,4092686,4047624,4084820,4029912,4089498,3655273,4001993,4030734,4103092,4066374,4063922,4066723,4063921,4049759,4080608,4080610,4050827,3657965,4052365,4052229,4051601,4055715,4055848,4058062,4058061,4052364,4052363,4058221,4050695,3657947,3657942,4050828,4051748,4051591,4058064,4055986,4052362,4051600,3657968,3657966,3662174,3657938,3662178,3657953,3657936,3662180,3657659,3662162,3657948,3657668,3657949,3657666,3657950,3657951,3662169,3657956,3662167,3657661,3657939,4058353,4056588,4052366,3657967,3657670,3662173,3657937,3662176,3662181,3657935,3662179,3657952,3662161,3657943,3657667,3657944,3657665,3657945,3657946,3662168,3657955,3657934,3662166,3657660,3657954,4055847,4055846,4052647,4058367,4055849,4058222,4050830,4050829,4002794,4047351,4102128,4116986,4095257,4114018,4095409,4110347,4028781,4114506,4088567,4058025,4081707,4055427,4104358,4009936,4031816,4053029,4071433,4094061,4107220,4083112,4103220,4096184,4029918,4045991,4103429,4012435,4011364,4007594,4103862,4096763,4009924,4103879,4017221,4045249,4109682,4079929,4054180,4065210,4101866,4095283,4066274,4094375,4049485,4008086,4103840,4058366,4005317,4087071,4001200,4008731,4107552,4099075,4027025,4070810,4008085,4023949,4035807,4030091,4119258,4094388,4104203,4009933,4052461,4094528,4066711,4052773,4051645,4009334,4070226,4058270,4103877,4100636,4048575,4052219,4045232,4054136,4106899,4055900,4000060,4111970,4037984,4100950,4014034,4111450,4083468,4101695,4103395,4049738,4069856,4099593,4008729,4049481,4033711,4061700,4025682,4077751,4069000,4028197,4023330,4032552,4069702,4077442,4105469,4028352,4103839,4058535,4099904,4065501,4049465,4101312,4035479,4065919,3655001,3655613,4035628,3655504,4021603,4006488,4077950,4077816,4032158,4030292,3655299,4071178,4009325,4078237,4085275,4034689,4051628,4008261,3655612,3655135,4084292,3655611,3655610,4001295,4003305,4084287,3654891,4003301,3655609,3655617,4044878,3655616,4115236,4001293,4002969,4100908,4102735,4090532,4003303,4067312,3663220,3655651,3663222,3655321,3655669,3663281,4003302,4002966,4001296,4001965,4084286,4080305,4062133,4115235,4090469,4001294,4003306,3655670,3655667,4002967,4001297,4001962,4002964,4110712,4029043,3655668,4028864,4002970,4105101,4083355,4001961,4002968,4114311,4031466,4003304,4060295,4060296,4060312,4001490,4001006,3655662,4021602,4028062,4029499,4028265,4028070,4099350,4028389,4028069,4107729,4119925,4049881,4048271,4119927,4032897,4041670,4032264,4008083,3655660,4003530,4103653,4119460,4094172,4053005,4002807,4001628,4002809,4001626,4001627,4003141,4001125,4002808,4001126,4001124,4104689,4110668,4056911,4032445,4088316,4008082,4028820,4097068,4049356,4031632,4057659,4066052,4032627,4029617,4009937,4082376,4078553,4009336,4057200,4069588,4064447,4035156,4038499,4070769,4057662,4078212,4074039,4068831,4025851,4029627,4099386,4082513,4099446,4052684,3655661,3655638,4096553,4080680,4112824,4112664,4110512,4034608,3655286,4052230,4052650,4093999,3655637,4090112,4049510,4092994,4023420,4041678,4043894,4043900,4003500,4034176,4028226,4043899,4029251,3662324,3662323,4080333,4090082,4087996,4096019,4109568,4109134,3662333,3657776,3657773,3662334,3657777,3657774,3657778,4089879,4044937,4078535,4047472,4087751,4046242,4002337,4087756,4080600,4059131,4045978,4092828,4084952,4116488,4114030,4097550,4112820,4082030,4080435,4039951,4027538,4108346,4090081,4080444,4084329,4106896,4077718,4088222,4091311,4026132,4055214,4055216,4026133,4058690,4055215,3655647,4032360,3655648,4018050,4065741,4037093,4025487,3655646,4080438,4069777,4030851,4019692,4082041,4043718,4082185,4021045,3661631,3655641,4080772,4080774,4082043,4080445,4094654,4008720,4092697,4093997,4071077,4084955,4056934,4057948,4020879,4042562,4087628,4044932,3655623,4008719,4028012,4029909,4030555,4055115,4056933,4103097,4100685,4047469,4041663,4102297,4103098,4088376,4100102,4044930,4051491,4052546,4031471,4027838,3655622,4080336,4104214,4080621,4085803,4082031,4082187,4087440,4051244,4033096,4084961,4090117,4112826,4059142,4060924,4032996,4080313,4091157,4100104,4084817,4104522,4066144,4047633,4055635,4083965,4062493,4080768,4080588,4001650,4001127,4001653,4002810,4002811,4003143,4001651,4003142,4001128,4001652,4001129,4009326,4051336,3655663,4032460,3655580,3656973,3656847,3655581,3655599,3655601,3655596,3655597,3655595,3655592,3655590,3655591,3655659,3655657,3655594,3655732,3655593,3655658,3663224,3655656,3655653,3655598,3655654,3663225,3655655,3655652,3663223,3655602,3655600,3655831,3655830,3656065,4080770,4080624,4051481,4090202,4048052,4080189,4080319,4080883,4080881,4070650,4070651,4070648,4084947,4080425,4051333,4080773,4080332,4080339,3655882,3655879,4051337,4048751,4047937,4080882,4027122,4041674,4048033,4043716,4082047,4110509,4104668,4030846,4044931,4080616,4080442,4080618,4030983,4032628,4065912,4093263,4031829,4066406,4034155,4063697,4091321,4090677,4080432,4034650,4052867,3655844,4103297,4001964,4001963,4033305,4033306,4003513,4003512,4033842,4083774,4033841,4031119,4001298,4031118,4100115,4048872,4003368,4001137,4001136,4003157,4080612,4093488,3655858,3655855,3655856,3655853,3655854,3663239,4084821,4082044,4057947,4008269,4099911,4030792,3655850,3655851,3655837,4029337,4029207,3655833,3655835,3655839,4042193,4119591,4103844,3655664,4091312,4090679,4080598,4009635,4096510,4093481,4082037,4084967,4081909,4057822,4059152,4080307,4025325,4033151,4055188,4032844,3655840,4082052,4077898,4081057,4010826,4017686,4080451,4093477,4025497,3655550,4055211,4092677,4088214,4080331,4087615,4089973,4087616,4086663,4067196,4093414,4085253,4009327,4110506,3661408,4110039,4050872,4110507,4053004,4029069,4008545,4047471,3655813,4075295,4086668,4088114,4059737,4052011,4103088,4080181,4026020,4042200,4084983,4031476,4081386,4032721,4033971,4033972,4080334,4084975,4090096,4099924,4034224,4013413,4002949,4087016,4085628,4085629,4112655,4114033,4082194,4031480,4080183,4102189,4071061,4024972,4034154,4102318,4028999,4050871,4087778,4051334,4049797,4065993,4066366,4029037,4105601,4087075,4084823,4056026,4063925,4068237,4023947,4002802,4035033,4119590,4119594,4087629,4083187,4093998,4082048,4108345,4048489,4110362,4071111,4032449,4110479,4056621,4018501,4048756,4080456,3657843,3655870,4106270,4035336,4056199,4094000,3655977,4042197,4092983,4068830,4084977,4081388,4050874,4117114,4102253,4114031,4046826,4093995,4047620,4089968,4102697,4100107,4008080,3654951,4082032,4009331,4117914,4066379,4007945,4032427,4088085,4080316,4030847,4109415,4080335,4093309,4105194,4052676,3655975,4009954,4048275,4071727,4048594,4071063,4102127,4111093,4108812,4108229,4049765,4116206,4047634,4043901,4119136,4041680,4041679,4025014,4089994,4063592,4080447,4035637,4034633,4024110,4078590,4080304,4080448,4080443,4084963,4093996,4009878,4037877,3655860,3655862,4031509,3655821,4058076,4058215,4058077,4052372,4058078,4050842,4052375,4055999,4058079,4055705,4058075,4052654,4052519,4055988,4052376,4050843,4052503,4058214,4051753,4055854,4052377,4058080,3655820,4047746,4103864,4004357,4009329,4066952,4032276,4032268,4009328,4032269,4031468,4031461,4032765,4030985,4016743,4041665,4042192,3655101,4080315,4031463,4047216,4081392,4080320,4080301,4032267,4001989,4080306,4087427,4009925,4090675,4098170,4082063,4063116,4041516,4002980,4003320,4003319,4001306,4001972,4048058,4060954,4080457,4080615,4090098,4031478,4041675,4105334,4046073,4091027,4087849,4055119,4026019,4044770,4087572,4105482,4101997,4051743,4053820,4009314,4077081,4105019,4079225,4056925,4033619,4088042,4100958,4014329,4096702,4057837,4098950,4030850,4029910,4001478,4048790,4053079,4080593,4062900,4080775,4080337,4058682,4059744,4119459,4080450,4087749,4090100,4116447,4035746,4028042,4044936,4087017,3661632,4067324,4010883,4096836,4079240,4082049,4084964,4078538,4094067,4060657,4082193,4081401,4090099,4103105,4093494,4089507,4090114,4093496,4098881,4038666,4009935,4096690,4074179,4056610,4081056,4047638,4084981,4081994,4034847,4001302,4003318,4034179,4003311,4009923,4088075,4091181,4003313,4091167,4003316,4093433,4068849,4040447,4045254,4091180,4001970,4001304,4001969,4003315,4001301,4003312,4086344,4090546,4030807,4098475,4087293,4091179,4051344,4032637,4084795,4003140,4102201,4088086,4022138,4119769,4090539,4028666,4033338,4080602,4032358,3662337,3662336,4111937,4032450,4116491,4062569,3655409,4045982,4042204,4028324,4049240,4048190,4058712,4087608,4000625,4112288,4008724,4063037,4030291,4035987,4093292,4085100,4041667,4093476,3656108,4111926,4084953,4030849,4000052,4084960,4080622,4035179,192549,442587,73361,134210,137721,135688,141168,193635,433903,444258,443766,132482,442572,193353,442632,444249,444202,258482,760084,3654640,80796,1245557,1245555,1245556,762190,762191,762192,762194,762195,762196,762197,442286,381308,197328,759844,3177019,759846,761380,201901,257010,441607,444271,761885,1246400,200757,1245041,1245040,198806,759845,3171351,759847,765221,31609,1076543,1245558,1245559,1076870,762198,762199,765475,764072,762200,762201,433738,434084,436634,1245347,436020,3200502,196623,196149,193238,257581,1340231,1449990,260125,254058,260139,198809,605554,3654663,433513,435840,141056,257004,139850,193240,3654664,193136,193140,200040,443911,194571,200334,198972,198978,133965,439673,192242,197490,374947,374925,30133,23798,31597,3654661,1077370,318222,604358,602297,141323,435734,1077384,136330,443566,133002,135350,136511,141662,141944,141666,134738,606232,133573,199074,376901,25297,378679,3654660,197035,196735,439670,3654658,260123,137900,1245077,24660,759843,255566,197795,257011,1077502,193120,436903,380944,254677,1244275,1244274,434581,438344,138347,257583,257007,443558,256439,442185,436024,133123,373684,438959,194560,256023,76022,435880,433703,444051,438070,437486,438960,444228,252548,601870,440448,440327,438685,442783,140435,80184,1244517,1245536,1245539,1244992,1244129,1244127,1244133,1244131,1244128,1244126,1244132,1244130,1244931,1246675,605412,1246155,605410,605411,1246156,605409,192259,3195259,141791,434281,3189639,317009,443217,376335,1076397,439730,605921,605920,132736,607328,607318,607317,607327,607330,607319,607326,760722,193402,441500,765865,438341,436339,438064,3654645,432545,436091,438133,320127,258458,257315,606935,133594,3174509,197206,440330,608816,1244189,605484,608808,608803,1074892,1246385,1245530,1245652,1245549,1245544,608799,608984,608800,608804,608996,1245534,1245535,1245540,1245531,603297,608988,3182462,1245547,3177960,1246354,1077119,608854,260130,760929,609016,608985,1076598,1245763,200440,141797,437216,433146,444448,82000,437720,437728,442574,444277,135974,192760,1074951,442170,442627,139193,439417,443763,435120,1075015,193070,444265,442563,436037,436902,1076114,435180,433145,256449,256451,756031,256722,441497,321212,3654605,3184177,3654625,3168407,439725,3174765,3189105,433415,432556,372247,1076580,433968,260041,29735,28974,80951,198363,444106,197218,442584,444418,141089,442638,605396,602647,605401,135027,444287,602289,602648,605400,200171,135335,132987,137212,440642,435613,75337,136496,79898,442068,3654603,30163,78497,197950,76493,1246543,1246544,762387,764983,3172917,76492,759854,759855,1245282,1245277,1245268,443786,1246527,761806,760152,765117,759850,759857,1246482,1246484,759856,1246508,1246509,1246480,3176352,762413,1246510,759852,1246516,762376,1246525,1246517,1246486,1246488,1246523,762412,759860,1245271,1245283,1245269,436720,134074,765508,762406,762401,443757,1246528,761807,765316,762411,759851,759858,1246483,1246485,765195,1246518,1246519,1246481,762414,1246520,759853,1246521,765476,1246526,1246522,1246487,1246489,1246524,762410,759859,1245270,1245278,1245279,1245280,1245281,443891,3169079,3170737,252544,433702,321502,443960,138973,765278,3179926,3180852,437221,443581,372550,438066,194288,72245,198076,23137,192956,198677,200629,434274,1245523,1245747,761312,1245522,761311,1245521,761313,3176778,439851,260730,602177,602190,1449989,255841,1077462,1076506,200765,432347,132932,139841,194863,196338,193699,76629,201503,193700,443781,193132,201785,198964,135722,380407,760054,760148,760188,198671,24970,26719,1075315,134668,1075312,373200,441321,255573,134735,137077,134454,132414,761374,134141,137964,606231,761373,132718,3188540,136205,195596,193814,26711,260034,377886,201908,259848,1075317,257012,134661,23220,375290,1245722,602181,602715,194574,192240,439674,763021,194280,193688,3175426,435182,437217,433401,3182795,260427,441921,602743,198075,436532,255084,433869,434279,381794,442630,442552,378352,375187,761333,761332,765217,765280,765071,761331,1245525,761784,761330,376697,761562,761347,761563,761346,439676,313236,432237,316631,433958,434857,319728,315469,436027,761860,372241,438681,260134,432310,440035,194265,134276,138954,436021,141498,140627,140947,200017,3180888,440953,252949,440032,140654,761366,761365,765220,440022,133228,137213,619034,619031,619032,619029,619028,619033,619030,765072,761340,761339,761341,135473,377910,140645,605544,195743,443778,197790,761363,761362,433413,440948,436641,440635,444041,438068,438359,435742,441784,444119,606836,443724,443725,439723,433694,435186,443739,436906,443456,438970,443722,438069,433524,441406,439407,31057,31602,254068,3654610,3654611,254669,3180406,435472,439719,3177027,606063,193239,3171929,762220,765113,762221,762222,762223,762224,762225,762226,762227,136332,436632,434570,435465,441507,433705,139734,440332,440043,195749,432831,200656,255477,141796,434868,193142,437786,137792,22350,374352,619694,441049,443881,376905,376026,443543,3654623,375185,198334,443462,199718,3189306,197223,194558,761334,761335,761336,195464,437496,201218,443879,1244339,1244368,1244378,1244379,1244380,1244340,138346,440939,194586,1340272,1340294,1340295,1340298,1340301,1340303,1340310,1340357,1340376,1340380,1340417,1340436,1340437,1340452,1340486,1340487,1340496,1340499,1340500,135745,3169917,3169354,438343,444300,436326,763017,605344,199067,437663,439736,1244886,434854,437773,196324,197776,438670,443444,618790,618796,604295,618775,618791,618793,618803,618794,619669,619670,618776,619671,618913,604294,618999,618914,618801,618915,618788,1075247,618779,1074918,619676,618787,619673,618800,1074917,1074940,618786,618792,618798,618789,618785,618998,619672,618780,618778,1074939,436637,444360,763528,432602,3185927,198822,132391,442325,444071,135611,602292,759836,602646,605398,602290,759835,436188,602293,759837,605397,605399,602291,765174,442753,444261,443775,439928,433696,764846,600575,192826,193133,377788,442777,132792,74855,79732,77340,442759,437202,437492,765005,439669,135466,372842,442586,444227,321505,374283,74864,444446,444059,132563,443888,605334,442112,196345,72562,443205,435746,433417,760135,30333,761872,199726,761941,3194810,252655,434277,260754,437538,440321,3178639,256036,439675,196029,194856,200031,439672,605653,3189876,197493,443632,194087,442066,132553,444429,377210,373127,436904,765831,440634,441787,605783,380324,606423,606425,443943,138682,438961,376028,440323,765405,372828,435463,140027,200319,261782,201211,76034,439683,314867,378078,439681,439682,373963,3181253,433134,318072,373972,442784,443204,436626,432554,439727,606047,441788,443540,193707,136911,438788,440129,28457,608083,199073,140480,132238,443863,435468,1244385,1244397,1448749,1448748,3571993,3572003,1448701,1075004,1244399,1448747,1244390,1244386,3182866,3175046,1074930,1074929,433639,3168246,608207,3187974,74998,3189195,1074948,1448709,1074947,1448708,3172455,765742,1076752,1076755,1076263,761909,1074905,1075031,1075037,1075409,1076753,444027,442559,436343,193708,436342,442273,442343,437214,200042,435470,440952,444075,441512,608295,436039,436038,440938,438358,436040,433135,434872,436334,435181,442320,198687,433124,432827,441786,440628,443596,443590,443546,441793,605650,441215,443535,440320,437774,618582,433125,432249,1244231,1074907,3184036,761972,3178539,601170,436180,603222,603221,608434,608433,760080,761604,1245757,3185580,72410,76504,1075224,1075225,1075046,1075047,606234,1075038,1075039,1075229,3177672,1075230,1075223,761802,764921,764924,764914,1075226,3190193,607418,1244276,606147,606773,761988,764121,761605,1245758,608863,605234,605196,605197,761801,444244,1076567,1075227,1076568,764992,761606,1245756,608864,201093,74434,1075228,607157,607156,3168830,3189518,3183822,3173728,3171163,3189614,3172719,3171993,3188620,3175361,198337,432250,433823,762465,192964,437784,443796,440716,762781,605831,1246240,1245532,1244725,1244726,1246668,1244727,1244728,1076373,437284,374020,605833,76508,1076515,1245517,1245516,1245513,1245515,1245514,1076949,1246117,1246118,1246119,1246120,1246121,1076950,1246122,1246123,1246124,1246125,1246126,381859,760111,760155,760196,441799,440053,138690,140961,140949,260936,607399,607400,606837,79072,607085,765607,320752,134284,137441,436859,434572,1245456,1245749,1245750,1245748,436340,196894,201221,192815,444062,443899,195462,198678,196347,197203,435509,374335,1245368,438077,1245367,1245370,761319,761321,761318,761320,619069,619070,761322,761323,765178,381789,439724,761368,761370,761367,761369,765905,761329,761328,444373,434273,761747,438680,437904,606070,372243,437794,436624,606028,606068,377802,439743,434866,435739,605192,439729,606038,3185989,432561,3198441,439668,444385,1244201,608986,1075043,1246325,1075006,1075044,1075045,3189457,3172720,1245543,601026,3188308,1075048,1245548,3175617,1246296,1077088,1077087,1075049,601027,1448938,1075050,1074967,433407,137207,432821,432246,438059,136627,1077006,443600,141209,440636,606148,440638,1246340,1246339,1246338,1246337,1246336,1246335,194287,438067,440285,618880,618881,437881,443054,443016,443291,434416,442757,443542,435785,1075271,437209,434860,442336,607088,78956,317208,380632,437777,436621,1449991,438338,319720,375458,312543,133691,380941,762645,375475,432631,3172535,440940,3170862,434559,194873,441219,133411,141216,3190125,257905,376422,765528,764828,765739,762761,3176618,3185648,141795,438975,378065,192824,433689,196628,200644,433961,442611,196329,3182223,440631,1076105,1076103,1076104,436900,433701,373483,444389,443453,442569,761739,442550,195191,439721,1075912,133566,1075913,1076290,440840,606046,1245740,1245739,1245738,373870,606032,606058,76221,606140,606033,761851,761852,606029,606034,375738,3191245,255175,194685,436636,201792,761699,761700,443761,80883,444103,142016,442640,132483,194799,760765,443594,439197,760764,444368,442351,137425,444436,136575,437491,443263,441925,440477,320317,139046,201136,437211,140648,373404,444117,432248,434942,132643,436333,438967,252552,141663,133853,1245553,1245552,1245551,1245550,1245768,1245554,1245769,1076480,1246150,1076477,443631,761371,761372,1246044,138847,137648,1076478,1076479,764065,761376,1244163,1244165,140191,134137,195901,1246669,765414,761375,1244162,1244164,133003,1244613,133296,373412,761766,765277,761714,761765,761713,437215,443866,1076199,439733,439857,257008,378753,432251,606044,440715,435816,1245588,1245589,441298,1245587,195460,193953,442291,195177,137057,759840,765175,761698,759841,759842,443427,759838,759839,3171677,432551,1076200,436897,132835,139737,199861,133803,606076,606077,196152,440751,760134,257778,438365,3172012,433966,434580,438362,134870,434271,760906,760907,765769,3170207,440328,432879,192361,258785,438350,255848,256723,605209,257908,254066,759817,759816,759815,260430,258180,253790,440431,252351,436145,759818,261324,607087,261053,253235,259048,254561,618647,761859,28179,440140,192670,377487,260028,192239,381504,1448860,3197956,437474,1244149,1074848,1244146,1245853,73409,199863,1244408,434391,437013,444121,134067,438071,79742,606040,255735,435457,433410,432541,134569,444407,1076289,600578,1340516,1340519,433957,3176805,433405,196325,442176,1076201,441501,3186646,441222,3178806,435028,260026,258354,443741,258684,256622,261325,253954,258061,437943,432621,1244438,609056,609057,376712,198189,198199,3181873,133547,72988,73838,3186103,81099,78829,80177,761965,764919,761944,765024,764920,761892,765813,761946,759808,761982,761945,434567,438353,442751,377793,433690,443327,3188217,602878,602879,760175,764205,760174,761768,761767,761769,605201,765433,443908,198192,756039,437222,261774,761351,761352,761348,761350,761349,200761,194982,437580,438063,438364,436035,1244206,608987,1075033,1246286,1075005,1075034,1075035,3173882,1245545,601028,1075040,3176245,1245546,1246258,1077045,1077044,1075041,601029,3173444,1448939,1075042,3187323,1074966,3172007,133406,133697,74564,444251,380943,3180007,80316,196328,133685,437772,134264,258333,3182069,434566,432564,605292,3186631,141213,436350,437499,437797,1449253,608997,608998,440033,762971,3178885,442637,437787,605341,605342,438968,605343,605340,442296,606074,201506,435179,312823,439731,444280,132797,763165,1076394,607321,607320,602996,607325,760987,603033,1244226,1075272,763027,760981,760984,3169209,3179701,3171261,196236,763164,442137,320651,440647,201780,261889,374278,134573,443699,433967,442710,618777,442864,443175,442714,443227,77716,442713,442711,443174,443173,75687,442712,195405,442863,607428,434859,434575,3191604,440023,443579,1245538,1076530,1076529,1246078,1076886,1076887,1076990,1076988,1075948,1076989,1075949,195461,435459,436090,259852,132392,24974,3181274,3178241,609055,609054,3182508,432244,1245537,1246053,3172934,437779,440390,28060,3654624,1246079,1245797,1245794,1245801,1245793,1246080,1246081,1245800,1246220,1246221,1245798,1245799,1245795,1246222,1245796,1246082,373408,3180317,602709,377300,765077,761379,605501,618804,618802,1448751,1448732,619675,618799,1448750,1448731,618795,618774,443858,444193,132780,80578,76270,444237,78025,196849,442135,443772,78916,442542,443860,195685,444111,76848,441170,80482,76992,136030,436033,74862,442345,194861,444294,76032,380030,133959,320646,315467,438971,378349,436031,318689,313416,313964,313698,444087,438348,441228,444083,378686,373139,320025,198345,377789,1075940,1076681,1076682,1076670,1076676,1245823,1075944,1075945,1075947,1076679,1076673,1076683,1075946,1244797,1076671,1076674,1076672,1076684,1245824,1076680,1076678,1076675,1076677,1245822,201511,438366,442316,435740,133024,438963,80946,134865,133141,436877,437434,443526,201214,440653,380640,375736,375184,602736,435188,441790,201798,200657,194871,443956,196907,75741,433695,442278,136898,375732,440937,139722,434557,201779,80626,438673,256896,374267,378953,75456,22820,374270,197204,73686,78672,196019,134851,193955,73122,761833,432816,260315,260630,253121,255454,256018,192818,441776,441775,606230,432236,261495,765006,137205,195176,444262,141777,198957,198674,72817,81496,374853,140018,258335,26899,444260,194268,258675,254266,252235,198336,441781,192819,602139,312825,254387,442796,195313,439686,609231,3179614,764968,81902,78073,439671,140633,3178291,3187442,3195293,3169965,443362,434272,134563,440158,259992,137785,140641,619343,26908,1245762,1245764,380038,606982,440029,435604,765931,372547,196620,140020,196895,196625,198683,197494,193693,381783,75555,760170,764996,433403,261326,1245180,436630,200652,373464,433960,261599,1245704,434275,373692,380942,443898,197782,132834,438958,444032,432829,433706,441210,432830)

) I
) C;

UPDATE STATISTICS #Codesets;


SELECT event_id, person_id, start_date, end_date, op_start_date, op_end_date, visit_occurrence_id
INTO #qualified_events
FROM 
(
  select pe.event_id, pe.person_id, pe.start_date, pe.end_date, pe.op_start_date, pe.op_end_date, row_number() over (partition by pe.person_id order by pe.start_date ASC) as ordinal, cast(pe.visit_occurrence_id as bigint) as visit_occurrence_id
  FROM (-- Begin Primary Events
select P.ordinal as event_id, P.person_id, P.start_date, P.end_date, op_start_date, op_end_date, cast(P.visit_occurrence_id as bigint) as visit_occurrence_id
FROM
(
  select E.person_id, E.start_date, E.end_date,
         row_number() OVER (PARTITION BY E.person_id ORDER BY E.sort_date ASC, E.event_id) ordinal,
         OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date, cast(E.visit_occurrence_id as bigint) as visit_occurrence_id
  FROM 
  (
  -- Begin Visit Occurrence Criteria
select C.person_id, C.visit_occurrence_id as event_id, C.start_date, C.end_date,
       C.visit_occurrence_id, C.start_date as sort_date
from 
(
  select vo.person_id,vo.visit_occurrence_id,vo.visit_concept_id,vo.visit_start_date as start_date, vo.visit_end_date as end_date 
  FROM @cdm_database_schema.VISIT_OCCURRENCE vo
JOIN #Codesets cs on (vo.visit_concept_id = cs.concept_id and cs.codeset_id = 0)
) C


-- End Visit Occurrence Criteria

  ) E
	JOIN @cdm_database_schema.observation_period OP on E.person_id = OP.person_id and E.start_date >=  OP.observation_period_start_date and E.start_date <= op.observation_period_end_date
  WHERE DATEADD(day,0,OP.OBSERVATION_PERIOD_START_DATE) <= E.START_DATE AND DATEADD(day,0,E.START_DATE) <= OP.OBSERVATION_PERIOD_END_DATE
) P

-- End Primary Events
) pe
  
) QE

;

--- Inclusion Rule Inserts

select 0 as inclusion_rule_id, person_id, event_id
INTO #Inclusion_0
FROM 
(
  select pe.person_id, pe.event_id
  FROM #qualified_events pe
  
JOIN (
-- Begin Criteria Group
select 0 as index_id, person_id, event_id
FROM
(
  select E.person_id, E.event_id 
  FROM #qualified_events E
  INNER JOIN
  (
    -- Begin Correlated Criteria
select 0 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM #qualified_events P
JOIN (
  -- Begin Condition Occurrence Criteria
SELECT C.person_id, C.condition_occurrence_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id, C.start_date as sort_date
FROM 
(
  SELECT co.person_id,co.condition_occurrence_id,co.condition_concept_id,co.visit_occurrence_id,co.condition_start_date as start_date, COALESCE(co.condition_end_date, DATEADD(day,1,co.condition_start_date)) as end_date 
  FROM @cdm_database_schema.CONDITION_OCCURRENCE co
  JOIN #Codesets cs on (co.condition_concept_id = cs.concept_id and cs.codeset_id = 14)
) C


-- End Condition Occurrence Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= DATEADD(day,0,P.START_DATE) AND A.START_DATE <= DATEADD(day,0,P.END_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

  ) CQ on E.person_id = CQ.person_id and E.event_id = CQ.event_id
  GROUP BY E.person_id, E.event_id
  HAVING COUNT(index_id) > 0
) G
-- End Criteria Group
) AC on AC.person_id = pe.person_id AND AC.event_id = pe.event_id
) Results
;

select 1 as inclusion_rule_id, person_id, event_id
INTO #Inclusion_1
FROM 
(
  select pe.person_id, pe.event_id
  FROM #qualified_events pe
  
JOIN (
-- Begin Criteria Group
select 0 as index_id, person_id, event_id
FROM
(
  select E.person_id, E.event_id 
  FROM #qualified_events E
  INNER JOIN
  (
    -- Begin Correlated Criteria
select 0 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM #qualified_events P
JOIN (
  select PE.person_id, PE.event_id, PE.start_date, PE.end_date, PE.visit_occurrence_id, PE.sort_date FROM (
-- Begin Drug Exposure Criteria
select C.person_id, C.drug_exposure_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id,C.start_date as sort_date
from 
(
  select de.person_id,de.drug_exposure_id,de.drug_concept_id,de.visit_occurrence_id,days_supply,quantity,refills,de.drug_exposure_start_date as start_date, COALESCE(de.drug_exposure_end_date, DATEADD(day,de.days_supply,de.drug_exposure_start_date), DATEADD(day,1,de.drug_exposure_start_date)) as end_date 
  FROM @cdm_database_schema.DRUG_EXPOSURE de
JOIN #Codesets cs on (de.drug_concept_id = cs.concept_id and cs.codeset_id = 13)
) C


-- End Drug Exposure Criteria

) PE
JOIN (
-- Begin Criteria Group
select 0 as index_id, person_id, event_id
FROM
(
  select E.person_id, E.event_id 
  FROM (SELECT Q.person_id, Q.event_id, Q.start_date, Q.end_date, Q.visit_occurrence_id, OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date
FROM (-- Begin Drug Exposure Criteria
select C.person_id, C.drug_exposure_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id,C.start_date as sort_date
from 
(
  select de.person_id,de.drug_exposure_id,de.drug_concept_id,de.visit_occurrence_id,days_supply,quantity,refills,de.drug_exposure_start_date as start_date, COALESCE(de.drug_exposure_end_date, DATEADD(day,de.days_supply,de.drug_exposure_start_date), DATEADD(day,1,de.drug_exposure_start_date)) as end_date 
  FROM @cdm_database_schema.DRUG_EXPOSURE de
JOIN #Codesets cs on (de.drug_concept_id = cs.concept_id and cs.codeset_id = 13)
) C


-- End Drug Exposure Criteria
) Q
JOIN @cdm_database_schema.OBSERVATION_PERIOD OP on Q.person_id = OP.person_id 
  and OP.observation_period_start_date <= Q.start_date and OP.observation_period_end_date >= Q.start_date
) E
  INNER JOIN
  (
    -- Begin Correlated Criteria
select 0 as index_id, p.person_id, p.event_id
from (SELECT Q.person_id, Q.event_id, Q.start_date, Q.end_date, Q.visit_occurrence_id, OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date
FROM (-- Begin Drug Exposure Criteria
select C.person_id, C.drug_exposure_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id,C.start_date as sort_date
from 
(
  select de.person_id,de.drug_exposure_id,de.drug_concept_id,de.visit_occurrence_id,days_supply,quantity,refills,de.drug_exposure_start_date as start_date, COALESCE(de.drug_exposure_end_date, DATEADD(day,de.days_supply,de.drug_exposure_start_date), DATEADD(day,1,de.drug_exposure_start_date)) as end_date 
  FROM @cdm_database_schema.DRUG_EXPOSURE de
JOIN #Codesets cs on (de.drug_concept_id = cs.concept_id and cs.codeset_id = 13)
) C


-- End Drug Exposure Criteria
) Q
JOIN @cdm_database_schema.OBSERVATION_PERIOD OP on Q.person_id = OP.person_id 
  and OP.observation_period_start_date <= Q.start_date and OP.observation_period_end_date >= Q.start_date
) p
LEFT JOIN (
SELECT p.person_id, p.event_id 
FROM (SELECT Q.person_id, Q.event_id, Q.start_date, Q.end_date, Q.visit_occurrence_id, OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date
FROM (-- Begin Drug Exposure Criteria
select C.person_id, C.drug_exposure_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id,C.start_date as sort_date
from 
(
  select de.person_id,de.drug_exposure_id,de.drug_concept_id,de.visit_occurrence_id,days_supply,quantity,refills,de.drug_exposure_start_date as start_date, COALESCE(de.drug_exposure_end_date, DATEADD(day,de.days_supply,de.drug_exposure_start_date), DATEADD(day,1,de.drug_exposure_start_date)) as end_date 
  FROM @cdm_database_schema.DRUG_EXPOSURE de
JOIN #Codesets cs on (de.drug_concept_id = cs.concept_id and cs.codeset_id = 13)
) C


-- End Drug Exposure Criteria
) Q
JOIN @cdm_database_schema.OBSERVATION_PERIOD OP on Q.person_id = OP.person_id 
  and OP.observation_period_start_date <= Q.start_date and OP.observation_period_end_date >= Q.start_date
) P
JOIN (
  -- Begin Visit Occurrence Criteria
select C.person_id, C.visit_occurrence_id as event_id, C.start_date, C.end_date,
       C.visit_occurrence_id, C.start_date as sort_date
from 
(
  select vo.person_id,vo.visit_occurrence_id,vo.visit_concept_id,vo.visit_start_date as start_date, vo.visit_end_date as end_date 
  FROM @cdm_database_schema.VISIT_OCCURRENCE vo
JOIN #Codesets cs on (vo.visit_concept_id = cs.concept_id and cs.codeset_id = 0)
) C


-- End Visit Occurrence Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= DATEADD(day,0,P.START_DATE) AND A.START_DATE <= DATEADD(day,0,P.START_DATE) ) cc on p.person_id = cc.person_id and p.event_id = cc.event_id
GROUP BY p.person_id, p.event_id
HAVING COUNT(cc.event_id) = 0
-- End Correlated Criteria

  ) CQ on E.person_id = CQ.person_id and E.event_id = CQ.event_id
  GROUP BY E.person_id, E.event_id
  HAVING COUNT(index_id) = 1
) G
-- End Criteria Group
) AC on AC.person_id = pe.person_id and AC.event_id = pe.event_id

) A on A.person_id = P.person_id  AND A.START_DATE >= DATEADD(day,-7,P.START_DATE) AND A.START_DATE <= DATEADD(day,0,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

UNION ALL
-- Begin Correlated Criteria
select 1 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM #qualified_events P
JOIN (
  select PE.person_id, PE.event_id, PE.start_date, PE.end_date, PE.visit_occurrence_id, PE.sort_date FROM (
-- Begin Condition Occurrence Criteria
SELECT C.person_id, C.condition_occurrence_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id, C.start_date as sort_date
FROM 
(
  SELECT co.person_id,co.condition_occurrence_id,co.condition_concept_id,co.visit_occurrence_id,co.condition_start_date as start_date, COALESCE(co.condition_end_date, DATEADD(day,1,co.condition_start_date)) as end_date 
  FROM @cdm_database_schema.CONDITION_OCCURRENCE co
  JOIN #Codesets cs on (co.condition_concept_id = cs.concept_id and cs.codeset_id = 15)
) C


-- End Condition Occurrence Criteria

) PE
JOIN (
-- Begin Criteria Group
select 0 as index_id, person_id, event_id
FROM
(
  select E.person_id, E.event_id 
  FROM (SELECT Q.person_id, Q.event_id, Q.start_date, Q.end_date, Q.visit_occurrence_id, OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date
FROM (-- Begin Condition Occurrence Criteria
SELECT C.person_id, C.condition_occurrence_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id, C.start_date as sort_date
FROM 
(
  SELECT co.person_id,co.condition_occurrence_id,co.condition_concept_id,co.visit_occurrence_id,co.condition_start_date as start_date, COALESCE(co.condition_end_date, DATEADD(day,1,co.condition_start_date)) as end_date 
  FROM @cdm_database_schema.CONDITION_OCCURRENCE co
  JOIN #Codesets cs on (co.condition_concept_id = cs.concept_id and cs.codeset_id = 15)
) C


-- End Condition Occurrence Criteria
) Q
JOIN @cdm_database_schema.OBSERVATION_PERIOD OP on Q.person_id = OP.person_id 
  and OP.observation_period_start_date <= Q.start_date and OP.observation_period_end_date >= Q.start_date
) E
  INNER JOIN
  (
    -- Begin Correlated Criteria
select 0 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM (SELECT Q.person_id, Q.event_id, Q.start_date, Q.end_date, Q.visit_occurrence_id, OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date
FROM (-- Begin Condition Occurrence Criteria
SELECT C.person_id, C.condition_occurrence_id as event_id, C.start_date, C.end_date,
  C.visit_occurrence_id, C.start_date as sort_date
FROM 
(
  SELECT co.person_id,co.condition_occurrence_id,co.condition_concept_id,co.visit_occurrence_id,co.condition_start_date as start_date, COALESCE(co.condition_end_date, DATEADD(day,1,co.condition_start_date)) as end_date 
  FROM @cdm_database_schema.CONDITION_OCCURRENCE co
  JOIN #Codesets cs on (co.condition_concept_id = cs.concept_id and cs.codeset_id = 15)
) C


-- End Condition Occurrence Criteria
) Q
JOIN @cdm_database_schema.OBSERVATION_PERIOD OP on Q.person_id = OP.person_id 
  and OP.observation_period_start_date <= Q.start_date and OP.observation_period_end_date >= Q.start_date
) P
JOIN (
  -- Begin Visit Occurrence Criteria
select C.person_id, C.visit_occurrence_id as event_id, C.start_date, C.end_date,
       C.visit_occurrence_id, C.start_date as sort_date
from 
(
  select vo.person_id,vo.visit_occurrence_id,vo.visit_concept_id,vo.visit_start_date as start_date, vo.visit_end_date as end_date 
  FROM @cdm_database_schema.VISIT_OCCURRENCE vo
JOIN #Codesets cs on (vo.visit_concept_id = cs.concept_id and cs.codeset_id = 10)
) C


-- End Visit Occurrence Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= DATEADD(day,0,P.START_DATE) AND A.START_DATE <= DATEADD(day,0,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

  ) CQ on E.person_id = CQ.person_id and E.event_id = CQ.event_id
  GROUP BY E.person_id, E.event_id
  HAVING COUNT(index_id) = 1
) G
-- End Criteria Group
) AC on AC.person_id = pe.person_id and AC.event_id = pe.event_id

) A on A.person_id = P.person_id  AND A.START_DATE >= DATEADD(day,-7,P.START_DATE) AND A.START_DATE <= DATEADD(day,0,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

  ) CQ on E.person_id = CQ.person_id and E.event_id = CQ.event_id
  GROUP BY E.person_id, E.event_id
  HAVING COUNT(index_id) > 0
) G
-- End Criteria Group
) AC on AC.person_id = pe.person_id AND AC.event_id = pe.event_id
) Results
;

SELECT inclusion_rule_id, person_id, event_id
INTO #inclusion_events
FROM (select inclusion_rule_id, person_id, event_id from #Inclusion_0
UNION ALL
select inclusion_rule_id, person_id, event_id from #Inclusion_1) I;
TRUNCATE TABLE #Inclusion_0;
DROP TABLE #Inclusion_0;

TRUNCATE TABLE #Inclusion_1;
DROP TABLE #Inclusion_1;


select event_id, person_id, start_date, end_date, op_start_date, op_end_date
into #included_events
FROM (
  SELECT event_id, person_id, start_date, end_date, op_start_date, op_end_date, row_number() over (partition by person_id order by start_date ASC) as ordinal
  from
  (
    select Q.event_id, Q.person_id, Q.start_date, Q.end_date, Q.op_start_date, Q.op_end_date, SUM(coalesce(POWER(cast(2 as bigint), I.inclusion_rule_id), 0)) as inclusion_rule_mask
    from #qualified_events Q
    LEFT JOIN #inclusion_events I on I.person_id = Q.person_id and I.event_id = Q.event_id
    GROUP BY Q.event_id, Q.person_id, Q.start_date, Q.end_date, Q.op_start_date, Q.op_end_date
  ) MG -- matching groups

  -- the matching group with all bits set ( POWER(2,# of inclusion rules) - 1 = inclusion_rule_mask
  WHERE (MG.inclusion_rule_mask = POWER(cast(2 as bigint),2)-1)

) Results

;

-- date offset strategy

select event_id, person_id, 
  case when DATEADD(day,0,end_date) > op_end_date then op_end_date else DATEADD(day,0,end_date) end as end_date
INTO #strategy_ends
from #included_events;


-- generate cohort periods into #final_cohort
select person_id, start_date, end_date
INTO #cohort_rows
from ( -- first_ends
	select F.person_id, F.start_date, F.end_date
	FROM (
	  select I.event_id, I.person_id, I.start_date, CE.end_date, row_number() over (partition by I.person_id, I.event_id order by CE.end_date) as ordinal
	  from #included_events I
	  join ( -- cohort_ends
-- cohort exit dates
-- End Date Strategy
SELECT event_id, person_id, end_date from #strategy_ends

    ) CE on I.event_id = CE.event_id and I.person_id = CE.person_id and CE.end_date >= I.start_date
	) F
	WHERE F.ordinal = 1
) FE;

select person_id, min(start_date) as start_date, end_date
into #final_cohort
from ( --cteEnds
	SELECT
		 c.person_id
		, c.start_date
		, MIN(ed.end_date) AS end_date
	FROM #cohort_rows c
	JOIN ( -- cteEndDates
    SELECT
      person_id
      , DATEADD(day,-1 * 1, event_date)  as end_date
    FROM
    (
      SELECT
        person_id
        , event_date
        , event_type
        , SUM(event_type) OVER (PARTITION BY person_id ORDER BY event_date, event_type ROWS UNBOUNDED PRECEDING) AS interval_status
      FROM
      (
        SELECT
          person_id
          , start_date AS event_date
          , -1 AS event_type
        FROM #cohort_rows

        UNION ALL


        SELECT
          person_id
          , DATEADD(day,1,end_date) as end_date
          , 1 AS event_type
        FROM #cohort_rows
      ) RAWDATA
    ) e
    WHERE interval_status = 0
  ) ed ON c.person_id = ed.person_id AND ed.end_date >= c.start_date
	GROUP BY c.person_id, c.start_date
) e
group by person_id, end_date
;

DELETE FROM @target_database_schema.@target_cohort_table where cohort_definition_id = @target_cohort_id;
INSERT INTO @target_database_schema.@target_cohort_table (cohort_definition_id, subject_id, cohort_start_date, cohort_end_date)
select @target_cohort_id as cohort_definition_id, person_id, start_date, end_date 
FROM #final_cohort CO
;


-- BEGIN: Censored Stats

delete from @results_database_schema.cohort_censor_stats where cohort_definition_id = @target_cohort_id;

-- END: Censored Stats



-- Create a temp table of inclusion rule rows for joining in the inclusion rule impact analysis

select cast(rule_sequence as int) as rule_sequence
into #inclusion_rules
from (
  SELECT CAST(0 as int) as rule_sequence UNION ALL SELECT CAST(1 as int) as rule_sequence
) IR;


-- Find the event that is the 'best match' per person.  
-- the 'best match' is defined as the event that satisfies the most inclusion rules.
-- ties are solved by choosing the event that matches the earliest inclusion rule, and then earliest.

select q.person_id, q.event_id
into #best_events
from #qualified_events Q
join (
	SELECT R.person_id, R.event_id, ROW_NUMBER() OVER (PARTITION BY R.person_id ORDER BY R.rule_count DESC,R.min_rule_id ASC, R.start_date ASC) AS rank_value
	FROM (
		SELECT Q.person_id, Q.event_id, COALESCE(COUNT(DISTINCT I.inclusion_rule_id), 0) AS rule_count, COALESCE(MIN(I.inclusion_rule_id), 0) AS min_rule_id, Q.start_date
		FROM #qualified_events Q
		LEFT JOIN #inclusion_events I ON q.person_id = i.person_id AND q.event_id = i.event_id
		GROUP BY Q.person_id, Q.event_id, Q.start_date
	) R
) ranked on Q.person_id = ranked.person_id and Q.event_id = ranked.event_id
WHERE ranked.rank_value = 1
;

-- modes of generation: (the same tables store the results for the different modes, identified by the mode_id column)
-- 0: all events
-- 1: best event


-- BEGIN: Inclusion Impact Analysis - event
-- calculte matching group counts
delete from @results_database_schema.cohort_inclusion_result where cohort_definition_id = @target_cohort_id and mode_id = 0;
insert into @results_database_schema.cohort_inclusion_result (cohort_definition_id, inclusion_rule_mask, person_count, mode_id)
select @target_cohort_id as cohort_definition_id, inclusion_rule_mask, count_big(*) as person_count, 0 as mode_id
from
(
  select Q.person_id, Q.event_id, CAST(SUM(coalesce(POWER(cast(2 as bigint), I.inclusion_rule_id), 0)) AS bigint) as inclusion_rule_mask
  from #qualified_events Q
  LEFT JOIN #inclusion_events I on q.person_id = i.person_id and q.event_id = i.event_id
  GROUP BY Q.person_id, Q.event_id
) MG -- matching groups
group by inclusion_rule_mask
;

-- calculate gain counts 
delete from @results_database_schema.cohort_inclusion_stats where cohort_definition_id = @target_cohort_id and mode_id = 0;
insert into @results_database_schema.cohort_inclusion_stats (cohort_definition_id, rule_sequence, person_count, gain_count, person_total, mode_id)
select @target_cohort_id as cohort_definition_id, ir.rule_sequence, coalesce(T.person_count, 0) as person_count, coalesce(SR.person_count, 0) gain_count, EventTotal.total, 0 as mode_id
from #inclusion_rules ir
left join
(
  select i.inclusion_rule_id, count_big(i.event_id) as person_count
  from #qualified_events Q
  JOIN #inclusion_events i on Q.person_id = I.person_id and Q.event_id = i.event_id
  group by i.inclusion_rule_id
) T on ir.rule_sequence = T.inclusion_rule_id
CROSS JOIN (select count(*) as total_rules from #inclusion_rules) RuleTotal
CROSS JOIN (select count_big(event_id) as total from #qualified_events) EventTotal
LEFT JOIN @results_database_schema.cohort_inclusion_result SR on SR.mode_id = 0 AND SR.cohort_definition_id = @target_cohort_id AND (POWER(cast(2 as bigint),RuleTotal.total_rules) - POWER(cast(2 as bigint),ir.rule_sequence) - 1) = SR.inclusion_rule_mask -- POWER(2,rule count) - POWER(2,rule sequence) - 1 is the mask for 'all except this rule'
;

-- calculate totals
delete from @results_database_schema.cohort_summary_stats where cohort_definition_id = @target_cohort_id and mode_id = 0;
insert into @results_database_schema.cohort_summary_stats (cohort_definition_id, base_count, final_count, mode_id)
select @target_cohort_id as cohort_definition_id, PC.total as person_count, coalesce(FC.total, 0) as final_count, 0 as mode_id
FROM
(select count_big(event_id) as total from #qualified_events) PC,
(select sum(sr.person_count) as total
  from @results_database_schema.cohort_inclusion_result sr
  CROSS JOIN (select count(*) as total_rules from #inclusion_rules) RuleTotal
  where sr.mode_id = 0 and sr.cohort_definition_id = @target_cohort_id and sr.inclusion_rule_mask = POWER(cast(2 as bigint),RuleTotal.total_rules)-1
) FC
;

-- END: Inclusion Impact Analysis - event

-- BEGIN: Inclusion Impact Analysis - person
-- calculte matching group counts
delete from @results_database_schema.cohort_inclusion_result where cohort_definition_id = @target_cohort_id and mode_id = 1;
insert into @results_database_schema.cohort_inclusion_result (cohort_definition_id, inclusion_rule_mask, person_count, mode_id)
select @target_cohort_id as cohort_definition_id, inclusion_rule_mask, count_big(*) as person_count, 1 as mode_id
from
(
  select Q.person_id, Q.event_id, CAST(SUM(coalesce(POWER(cast(2 as bigint), I.inclusion_rule_id), 0)) AS bigint) as inclusion_rule_mask
  from #best_events Q
  LEFT JOIN #inclusion_events I on q.person_id = i.person_id and q.event_id = i.event_id
  GROUP BY Q.person_id, Q.event_id
) MG -- matching groups
group by inclusion_rule_mask
;

-- calculate gain counts 
delete from @results_database_schema.cohort_inclusion_stats where cohort_definition_id = @target_cohort_id and mode_id = 1;
insert into @results_database_schema.cohort_inclusion_stats (cohort_definition_id, rule_sequence, person_count, gain_count, person_total, mode_id)
select @target_cohort_id as cohort_definition_id, ir.rule_sequence, coalesce(T.person_count, 0) as person_count, coalesce(SR.person_count, 0) gain_count, EventTotal.total, 1 as mode_id
from #inclusion_rules ir
left join
(
  select i.inclusion_rule_id, count_big(i.event_id) as person_count
  from #best_events Q
  JOIN #inclusion_events i on Q.person_id = I.person_id and Q.event_id = i.event_id
  group by i.inclusion_rule_id
) T on ir.rule_sequence = T.inclusion_rule_id
CROSS JOIN (select count(*) as total_rules from #inclusion_rules) RuleTotal
CROSS JOIN (select count_big(event_id) as total from #best_events) EventTotal
LEFT JOIN @results_database_schema.cohort_inclusion_result SR on SR.mode_id = 1 AND SR.cohort_definition_id = @target_cohort_id AND (POWER(cast(2 as bigint),RuleTotal.total_rules) - POWER(cast(2 as bigint),ir.rule_sequence) - 1) = SR.inclusion_rule_mask -- POWER(2,rule count) - POWER(2,rule sequence) - 1 is the mask for 'all except this rule'
;

-- calculate totals
delete from @results_database_schema.cohort_summary_stats where cohort_definition_id = @target_cohort_id and mode_id = 1;
insert into @results_database_schema.cohort_summary_stats (cohort_definition_id, base_count, final_count, mode_id)
select @target_cohort_id as cohort_definition_id, PC.total as person_count, coalesce(FC.total, 0) as final_count, 1 as mode_id
FROM
(select count_big(event_id) as total from #best_events) PC,
(select sum(sr.person_count) as total
  from @results_database_schema.cohort_inclusion_result sr
  CROSS JOIN (select count(*) as total_rules from #inclusion_rules) RuleTotal
  where sr.mode_id = 1 and sr.cohort_definition_id = @target_cohort_id and sr.inclusion_rule_mask = POWER(cast(2 as bigint),RuleTotal.total_rules)-1
) FC
;

-- END: Inclusion Impact Analysis - person

TRUNCATE TABLE #best_events;
DROP TABLE #best_events;

TRUNCATE TABLE #inclusion_rules;
DROP TABLE #inclusion_rules;


TRUNCATE TABLE #strategy_ends;
DROP TABLE #strategy_ends;


TRUNCATE TABLE #cohort_rows;
DROP TABLE #cohort_rows;

TRUNCATE TABLE #final_cohort;
DROP TABLE #final_cohort;

TRUNCATE TABLE #inclusion_events;
DROP TABLE #inclusion_events;

TRUNCATE TABLE #qualified_events;
DROP TABLE #qualified_events;

TRUNCATE TABLE #included_events;
DROP TABLE #included_events;

TRUNCATE TABLE #Codesets;
DROP TABLE #Codesets;
